

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Global Air Quality Index &#8212; CAMS Training</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'proc-glob-eaqi';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Antarctic Ozone Hole Monitoring Tutorial" href="proc-ozone.html" />
    <link rel="prev" title="European Air Quality Index Calculation" href="proc-aq-index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/CAMS–POS–LINE.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/CAMS–POS–LINE.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Copernicus Atmosphere Monitoring Service (CAMS) Data Tutorials
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Data Access Tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://ads.atmosphere.copernicus.eu/user-guide">ADS User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="da-read-write.html">Import, Reduce, Export</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Data Visualisation Tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="vis-maps.html">Maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="vis-animations.html">Animations</a></li>
<li class="toctree-l1"><a class="reference internal" href="vis-time-series.html">Time Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="vis-profiles.html">Profile Plots and Zonal Means</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Product Tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="cams-global-forecast-aeronet.html">CAMS global forecasts</a></li>
<li class="toctree-l1"><a class="reference internal" href="cams-regional-forecast.html">CAMS regional forecasts</a></li>
<li class="toctree-l1"><a class="reference internal" href="cams-global-reanalysis.html">CAMS global reanalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="cams-emissions.html">Emissions inventories</a></li>
<li class="toctree-l1"><a class="reference internal" href="cams-mos.html">CAMS Model Output Statistics</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Data Processing Tutorials</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="proc-aq-index.html">European Air Quality Index Calculation</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Global Air Quality Index Calculation</a></li>
<li class="toctree-l1"><a class="reference internal" href="proc-ozone.html">Antarctic Ozone Hole Monitoring</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Averaging kernels tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1-satellite-model-comparison-theory.html">Satellite and model comparison theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="2-ozone-profile-tropomi-analysis.html">ozone satellite and model comparison</a></li>
<li class="toctree-l1"><a class="reference internal" href="3-no2-tropomi-cams-regional.html">NO2 satellite and model comparison</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Climate Data Processing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://ecmwf-projects.github.io/copernicus-training-c3s/">Tutorials from the Copernicus Climate Change Service (C3S)</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/ecmwf-training/cams-training/main?urlpath=tree/proc-glob-eaqi.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-training/cams-training" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-training/cams-training/issues/new?title=Issue%20on%20page%20%2Fproc-glob-eaqi.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/proc-glob-eaqi.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Global Air Quality Index</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-objectives">Learning objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-setup">Initial setup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#add-your-ads-api-credentials">Add your ADS API credentials</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries">Import libraries</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#explore-and-download-data">Explore and download data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#manual-download">Manual download</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#api-download">API download</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aerosols-and-meteorological-data">Aerosols and meteorological data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trace-gases">Trace gases</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unit-transformation">Unit transformation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#h-max-and-mean-average">24h max and mean average</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-the-global-concentrations-forecasts-of-trace-gases-and-particulate-matter">Plotting the global concentrations forecasts of trace gases and particulate matter</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-the-air-quality-index">Calculating the air quality index</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#global-aqi-map">Global AQI map</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#air-quality-heatmap-for-kjeller">Air quality heatmap for Kjeller</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#appendix-scaling-factor">Appendix - Scaling factor</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <p><img alt="logo" src="https://climate.copernicus.eu/sites/default/files/custom-uploads/branding/LogoLine_horizon_CAMS.png" /></p>
<section class="tex2jax_ignore mathjax_ignore" id="global-air-quality-index">
<h1>Global Air Quality Index<a class="headerlink" href="#global-air-quality-index" title="Permalink to this heading">#</a></h1>
<p><strong>Run the tutorial via free cloud platforms</strong>: <a class="reference external" href="https://mybinder.org/v2/gh/ecmwf-training/2024-cams-act6-training/main?labpath=08-aqi/cams_glob_eaqi.ipynb"><img alt="binder" src="https://mybinder.org/badge.svg" /></a>
<a class="reference external" href="https://kaggle.com/kernels/welcome?src=https://github.com/ecmwf-training/2024-cams-act6-training/blob/main/08-aqi/cams_glob_eaqi.ipynb"><img alt="kaggle" src="https://kaggle.com/static/images/open-in-kaggle.svg" /></a>
<a class="reference external" href="https://colab.research.google.com/github/ecmwf-training/2024-cams-act6-training/blob/main/08-aqi/cams_glob_eaqi.ipynb"><img alt="colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<section id="learning-objectives">
<h2>Learning objectives<a class="headerlink" href="#learning-objectives" title="Permalink to this heading">#</a></h2>
<p>In this notebook we’ll compute the forecasts of the global air quality index (AQI). The computation of the AQI forecast is based on the forecast concentration of the following pollutants: <span class="math notranslate nohighlight">\(O_3, NO_2, SO_2, PM2.5, PM10\)</span>. The index is computed according to the <a class="reference external" href="https://en.wikipedia.org/wiki/Air_quality_index#Europe">European Air Quality Index</a> definition. The concentration of the pollutants will be time averaged and transformed in <span class="math notranslate nohighlight">\(\mu g \cdot m^{-3}\)</span> and finally classified in one of six levels, from <em>Good</em> to <em>Extremly poor</em>, according to the threshold levels defined in the European Air Quality Index. The air quality index is the highest value of the concentration levels of the pollutants. For instance, if the concentration level in a grid cell for <span class="math notranslate nohighlight">\(NO_2, SO_2, PM2.5, PM10\)</span> is <em>Good</em> but for <span class="math notranslate nohighlight">\(O_3\)</span> is <em>Mediocre</em>, then the air quality index for that grid cell is <em>Mediocre</em>.</p>
</section>
<section id="initial-setup">
<h2>Initial setup<a class="headerlink" href="#initial-setup" title="Permalink to this heading">#</a></h2>
<p>Before we begin we must prepare our computing environment. This includes installing the client software of the Application Programming Interface (API) of the Climate Data Store (CDS), intalling all the packages required to execute the code, setting up our CDS API credentials and importing the various Python libraries that will be used. If you are executing this notebook on your laptop it is assumed that you have created a conda environment with all the packages installed as specified in the <em>environment.yml</em> file in the root folder of the repository. On the other hand, if you are using a cloud environment, such as Google Colab, you will have to uncomment the following cell to install those packages since they are not provided by default.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># If you are running this notebook in Colab, ensure that the cdsapi package is installed</span>
<span class="c1">#!pip install -q cdsapi</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># If you are running this notebook in Colab, uncomment the line below and run this cell.</span>
<span class="c1">#!pip install cartopy</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># If you are running this notebook in Colab, uncomment the line below and run this cell</span>
<span class="c1">#!pip install xarray==2024.7.0</span>
</pre></div>
</div>
</div>
</div>
<section id="add-your-ads-api-credentials">
<h3>Add your ADS API credentials<a class="headerlink" href="#add-your-ads-api-credentials" title="Permalink to this heading">#</a></h3>
<p>To set up your ADS API credentials, please login/register on the <a class="reference external" href="https://ads.atmosphere.copernicus.eu/">ADS</a>, then you will see your unique API key in your <a class="reference external" href="https://ads.atmosphere.copernicus.eu/profile">profile</a>.</p>
<p>You can copy your API key to your current session by replacing <code class="docutils literal notranslate"><span class="pre">#########</span></code> in the code cell below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CDSAPI_URL&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;https://ads.atmosphere.copernicus.eu/api&#39;</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CDSAPI_KEY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;###########################################&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="import-libraries">
<h3>Import libraries<a class="headerlink" href="#import-libraries" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">mcol</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span><span class="p">,</span> <span class="n">ticker</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">ListedColormap</span>
<span class="kn">import</span> <span class="nn">cartopy</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">cartopy.feature</span> <span class="k">as</span> <span class="nn">cfeature</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">zipfile</span> <span class="kn">import</span> <span class="n">ZipFile</span>
<span class="kn">import</span> <span class="nn">cdsapi</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">platform</span> <span class="kn">import</span> <span class="n">python_version</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Python version: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">python_version</span>())
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;NumPy version: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">np</span>.version.version)
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pandas version: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">pd</span>.__version__)
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Xarray version: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">xr</span>.__version__)
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Matplotlib version: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">matplotlib</span>.__version__)
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cartopy version: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">cartopy</span>.__version__)
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Seaborn version: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">sns</span>.__version__)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Python version: 3.12.5
NumPy version: 2.0.2
Pandas version: 2.2.2
Xarray version: 2024.7.0
Matplotlib version: 3.9.2
Cartopy version: 0.23.0
Seaborn version: 0.13.2
</pre></div>
</div>
</div>
</div>
<p>Here we specify a data directory in which we will download our data and all output files that we will generate:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DATADIR</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="explore-and-download-data">
<h2>Explore and download data<a class="headerlink" href="#explore-and-download-data" title="Permalink to this heading">#</a></h2>
<p>We use the <a class="reference external" href="https://ads.atmosphere.copernicus.eu/datasets/cams-global-atmospheric-composition-forecasts">CAMS global atmospheric composition forecasts</a> dataset. The spatial resolution is lower than that available for the <a class="reference external" href="https://ads.atmosphere.copernicus.eu/cdsapp#!/dataset/cams-europe-air-quality-forecasts?tab=overview">CAMS European air quality forecasts</a> used in the previous edition of the training event but it covers the whole planet. The dataset is available from the Copernicus Atmosphere Monitoring Service (CAMS). The spatial grid is 0.4° x 0.4° so that each cell has size 44 km x 44 km, approximately.  In order to compute the air quality index for each grid cell we will download the data of the pollutants and the meteorological data: surface pressure, and 2m air temperature. The trace gases are provided for 137 vertical levels and are available at 3-hours intervals. We will download the trace gases data only for the surface level, that is level 137. The particulate matter and the meteorological data are available at a single level (surface) at hourly intervals.</p>
<ul class="simple">
<li><p>Ozone mass mixing ratio [kg kg**-1]</p></li>
<li><p>Sulphur dioxide mass mixing ratio [kg kg**-1]</p></li>
<li><p>Nitrogen dioxide mass mixing ratio [kg kg**-1]</p></li>
<li><p>Particulate matter d &lt;= 2.5 um [kg m**-3]</p></li>
<li><p>Particulate matter d &lt;= 10 um [kg m**-3]</p></li>
<li><p>Surface pressure [Pa]</p></li>
<li><p>2m air temperature [K]</p></li>
</ul>
<p>The concentration of the trace gases is given using a dimensionless unit. Since we want to use a common unit for all the pollutants we will have to transform the trace gases data from a dimensionless unit to mass concentration. We will use the surface pressure and the air temperature to perform such transformation. We will request the forecast data for 96 hours, 4 days, starting from the current day at time 00:00</p>
</section>
<section id="manual-download">
<h2>Manual download<a class="headerlink" href="#manual-download" title="Permalink to this heading">#</a></h2>
<p>The Copernicus Atmosphere Monitoring Service provides a user interface to select the dataset and the variables of interest and download the data from their website, in addition to the APIs. This option is useful in order to have an understanging of what variables are included in a dataset and how to build a request. The web page allows a user to copy the code to submit a request using the APIs. We can visit the <a class="reference external" href="https://ads.atmosphere.copernicus.eu/datasets/cams-global-atmospheric-composition-forecasts?tab=download">download form for the CAMS global forecast data</a> and select the variables of interest. We select in the “Single level” panel</p>
<ul class="simple">
<li><p>2m temperature</p></li>
<li><p>surface pressure</p></li>
<li><p>Particulate matter d &lt; 2.5 µm (PM2.5)</p></li>
<li><p>Particulate matter d &lt; 10 µm (PM10)</p></li>
</ul>
<p>In the “Multi level” panel, we select</p>
<ul class="simple">
<li><p>Nitrogen dioxide</p></li>
<li><p>Ozone</p></li>
<li><p>Sulphur dioxide</p></li>
</ul>
<p>In the “Model level” panel we select 137 (ground level)</p>
<p>For the date, we may select the current date for both start and end date. For the “Time”, that is the hour of the beginning of the forecasts we may select 00:00.</p>
<p>In the “Leadtime hour” panel we can flag all the check boxes from 0 to 95 for a 4 days forecast.</p>
<p>At the end of the download form, select <strong>Show API request</strong>. This will reveal a block of code, which contains the same settings as the code cells for the APIs download that we will use in the API download.</p>
<p><strong>Please remember to accept the terms and conditions at the bottom of the download form.</strong></p>
<p>You might want to have a look at the content of the dataset using a NetCDF visualization tool such as <a class="reference external" href="https://www.giss.nasa.gov/tools/panoply/">Panoply</a></p>
<p><img alt="global O3" src="_images/panoply.jpg" /></p>
</section>
<section id="api-download">
<h2>API download<a class="headerlink" href="#api-download" title="Permalink to this heading">#</a></h2>
<p>Once we have a better knowledge of the dataset, which names are used for our variables of interest, and the forecast days and times, we can set up a request to be sent through the CDS APIs</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_date</span> <span class="o">=</span> <span class="s1">&#39;2024-10-03&#39;</span>
<span class="n">end_date</span> <span class="o">=</span> <span class="s1">&#39;2024-10-03&#39;</span>
<span class="n">init_hour</span> <span class="o">=</span> <span class="s1">&#39;00&#39;</span>
<span class="n">lead_time_start</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">lead_time_stop</span> <span class="o">=</span> <span class="mi">96</span>
<span class="n">step_hours</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">leadtime_hours</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">lead_time_start</span><span class="p">,</span> <span class="n">lead_time_stop</span> <span class="o">+</span> <span class="n">lead_time_start</span><span class="p">,</span> <span class="n">step_hours</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variables</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;2m_temperature&#39;</span><span class="p">,</span>
            <span class="s1">&#39;surface_pressure&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;particulate_matter_2.5um&#39;</span><span class="p">,</span>
            <span class="s1">&#39;particulate_matter_10um&#39;</span><span class="p">,</span>
            <span class="s1">&#39;nitrogen_dioxide&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;ozone&#39;</span><span class="p">,</span>
            <span class="s1">&#39;sulphur_dioxide&#39;</span><span class="p">]</span>
<span class="n">bb_north</span> <span class="o">=</span> <span class="mi">90</span>
<span class="n">bb_south</span> <span class="o">=</span> <span class="o">-</span><span class="mi">90</span>
<span class="n">bb_west</span> <span class="o">=</span> <span class="o">-</span><span class="mi">180</span>
<span class="n">bb_east</span> <span class="o">=</span> <span class="mi">180</span>
<span class="n">area</span> <span class="o">=</span> <span class="p">[</span><span class="n">bb_north</span><span class="p">,</span> <span class="n">bb_west</span><span class="p">,</span> <span class="n">bb_south</span><span class="p">,</span> <span class="n">bb_east</span><span class="p">]</span>  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="s1">&#39;cams-global-atmospheric-composition-forecasts&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="n">variables</span><span class="p">,</span>
		<span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">start_date</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">end_date</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">init_hour</span><span class="si">}</span><span class="s1">:00&#39;</span><span class="p">,</span>
        <span class="s1">&#39;leadtime_hour&#39;</span><span class="p">:</span> <span class="n">leadtime_hours</span><span class="p">,</span>
        <span class="s1">&#39;model_level&#39;</span><span class="p">:</span> <span class="s1">&#39;137&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;forecast&#39;</span><span class="p">,</span>
        <span class="s1">&#39;area&#39;</span><span class="p">:</span> <span class="n">area</span><span class="p">,</span>
        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;netcdf_zip&#39;</span>
    <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">cdsapi</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="n">c</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span>
    <span class="n">dataset</span><span class="p">,</span>
    <span class="n">request</span><span class="p">,</span>
    <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">/download.zip&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-10-04 09:51:16,228 WARNING [2024-10-04T07:51:15.581596] You are using a deprecated API endpoint. If you are using cdsapi, please upgrade to the latest version.
2024-10-04 09:51:16,229 INFO Request ID is 09f66ddd-7a47-466a-ae5f-a7857662a3d8
2024-10-04 09:51:16,268 INFO status has been updated to accepted
2024-10-04 09:51:17,804 INFO status has been updated to running
2024-10-04 09:52:30,516 INFO status has been updated to successful
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "", "version_major": 2, "version_minor": 0}</script><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;./download.zip&#39;
</pre></div>
</div>
</div>
</div>
<p>We open the zip file to extract the NetCDF data files. Trace gases concentrations are in the multi-level variable file data_mlev.nc. The particulate matter concentrations and the meteorological variables, 2m air temperature and surface pressure, are in the single level variables file data_sfc.nc.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">ZipFile</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">/download.zip&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zipObj</span><span class="p">:</span>
   <span class="n">zipObj</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">/&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can remove the zip file</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">/download.zip&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="aerosols-and-meteorological-data">
<h2>Aerosols and meteorological data<a class="headerlink" href="#aerosols-and-meteorological-data" title="Permalink to this heading">#</a></h2>
<p>The concentration of aerosol PM2.5 and PM10 are provided as densities in <span class="math notranslate nohighlight">\(kg \cdot m^{-3}\)</span>, the 2m air temperature in Kelvin, the surface pressure in Pascal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">single_level_ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">/data_sfc.nc&#39;</span><span class="p">)</span> 
<span class="n">single_level_ds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 623MB
Dimensions:                  (forecast_period: 96, forecast_reference_time: 1,
                              latitude: 451, longitude: 900)
Coordinates:
  * forecast_period          (forecast_period) timedelta64[ns] 768B 00:00:00 ...
  * forecast_reference_time  (forecast_reference_time) datetime64[ns] 8B 2024...
  * latitude                 (latitude) float64 4kB 90.0 89.6 ... -89.6 -90.0
  * longitude                (longitude) float64 7kB -180.0 -179.6 ... 179.6
    valid_time               (forecast_reference_time, forecast_period) datetime64[ns] 768B ...
Data variables:
    t2m                      (forecast_period, forecast_reference_time, latitude, longitude) float32 156MB ...
    sp                       (forecast_period, forecast_reference_time, latitude, longitude) float32 156MB ...
    pm2p5                    (forecast_period, forecast_reference_time, latitude, longitude) float32 156MB ...
    pm10                     (forecast_period, forecast_reference_time, latitude, longitude) float32 156MB ...
Attributes:
    GRIB_centre:             ecmf
    GRIB_centreDescription:  European Centre for Medium-Range Weather Forecasts
    GRIB_subCentre:          0
    Conventions:             CF-1.7
    institution:             European Centre for Medium-Range Weather Forecasts
    history:                 2024-10-04T07:51 GRIB to CDM+CF via cfgrib-0.9.1...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-396edafd-1793-4f8c-8b4d-736a22c7490c' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-396edafd-1793-4f8c-8b4d-736a22c7490c' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>forecast_period</span>: 96</li><li><span class='xr-has-index'>forecast_reference_time</span>: 1</li><li><span class='xr-has-index'>latitude</span>: 451</li><li><span class='xr-has-index'>longitude</span>: 900</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-05d488f4-df34-40d1-8782-4ed4c9a2cbcc' class='xr-section-summary-in' type='checkbox'  checked><label for='section-05d488f4-df34-40d1-8782-4ed4c9a2cbcc' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>forecast_period</span></div><div class='xr-var-dims'>(forecast_period)</div><div class='xr-var-dtype'>timedelta64[ns]</div><div class='xr-var-preview xr-preview'>00:00:00 ... 3 days 23:00:00</div><input id='attrs-e2ee592f-fe38-4b73-931a-8558a1cb997b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e2ee592f-fe38-4b73-931a-8558a1cb997b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8151b870-a572-47f2-9868-336bf66b6545' class='xr-var-data-in' type='checkbox'><label for='data-8151b870-a572-47f2-9868-336bf66b6545' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time since forecast_reference_time</dd><dt><span>standard_name :</span></dt><dd>forecast_period</dd></dl></div><div class='xr-var-data'><pre>array([              0,   3600000000000,   7200000000000,  10800000000000,
        14400000000000,  18000000000000,  21600000000000,  25200000000000,
        28800000000000,  32400000000000,  36000000000000,  39600000000000,
        43200000000000,  46800000000000,  50400000000000,  54000000000000,
        57600000000000,  61200000000000,  64800000000000,  68400000000000,
        72000000000000,  75600000000000,  79200000000000,  82800000000000,
        86400000000000,  90000000000000,  93600000000000,  97200000000000,
       100800000000000, 104400000000000, 108000000000000, 111600000000000,
       115200000000000, 118800000000000, 122400000000000, 126000000000000,
       129600000000000, 133200000000000, 136800000000000, 140400000000000,
       144000000000000, 147600000000000, 151200000000000, 154800000000000,
       158400000000000, 162000000000000, 165600000000000, 169200000000000,
       172800000000000, 176400000000000, 180000000000000, 183600000000000,
       187200000000000, 190800000000000, 194400000000000, 198000000000000,
       201600000000000, 205200000000000, 208800000000000, 212400000000000,
       216000000000000, 219600000000000, 223200000000000, 226800000000000,
       230400000000000, 234000000000000, 237600000000000, 241200000000000,
       244800000000000, 248400000000000, 252000000000000, 255600000000000,
       259200000000000, 262800000000000, 266400000000000, 270000000000000,
       273600000000000, 277200000000000, 280800000000000, 284400000000000,
       288000000000000, 291600000000000, 295200000000000, 298800000000000,
       302400000000000, 306000000000000, 309600000000000, 313200000000000,
       316800000000000, 320400000000000, 324000000000000, 327600000000000,
       331200000000000, 334800000000000, 338400000000000, 342000000000000],
      dtype=&#x27;timedelta64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>forecast_reference_time</span></div><div class='xr-var-dims'>(forecast_reference_time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2024-10-03</div><input id='attrs-623dd086-49ab-44f4-882c-f0367579197e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-623dd086-49ab-44f4-882c-f0367579197e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2fccc4be-a87d-4baf-8b41-6e30b7b8bce4' class='xr-var-data-in' type='checkbox'><label for='data-2fccc4be-a87d-4baf-8b41-6e30b7b8bce4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>initial time of forecast</dd><dt><span>standard_name :</span></dt><dd>forecast_reference_time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2024-10-03T00:00:00.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>90.0 89.6 89.2 ... -89.6 -90.0</div><input id='attrs-75b39ce4-bd18-4ec3-942f-8ad179832673' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-75b39ce4-bd18-4ec3-942f-8ad179832673' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-71d322a9-abf6-4954-9f5c-61a6df31ed08' class='xr-var-data-in' type='checkbox'><label for='data-71d322a9-abf6-4954-9f5c-61a6df31ed08' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>stored_direction :</span></dt><dd>decreasing</dd></dl></div><div class='xr-var-data'><pre>array([ 90. ,  89.6,  89.2, ..., -89.2, -89.6, -90. ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-180.0 -179.6 ... 179.2 179.6</div><input id='attrs-b77ac8d5-26de-41b3-be96-0b781a6873ef' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b77ac8d5-26de-41b3-be96-0b781a6873ef' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ca9b754c-92c8-44a1-a438-d718ce902212' class='xr-var-data-in' type='checkbox'><label for='data-ca9b754c-92c8-44a1-a438-d718ce902212' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-180. , -179.6, -179.2, ...,  178.8,  179.2,  179.6])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>valid_time</span></div><div class='xr-var-dims'>(forecast_reference_time, forecast_period)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-8203cf5b-676e-4a07-990f-002529f1833b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8203cf5b-676e-4a07-990f-002529f1833b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2de8c827-4c75-42ec-9e61-d394d50cf28b' class='xr-var-data-in' type='checkbox'><label for='data-2de8c827-4c75-42ec-9e61-d394d50cf28b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>[96 values with dtype=datetime64[ns]]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f8edce23-e6be-427d-9a2b-e2582d6aa8c4' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f8edce23-e6be-427d-9a2b-e2582d6aa8c4' class='xr-section-summary' >Data variables: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>t2m</span></div><div class='xr-var-dims'>(forecast_period, forecast_reference_time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-33d9e8aa-46b9-4151-8efe-0e4e13f8ce56' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-33d9e8aa-46b9-4151-8efe-0e4e13f8ce56' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-05817f14-c1a2-475b-b2b5-ea1d81d55a67' class='xr-var-data-in' type='checkbox'><label for='data-05817f14-c1a2-475b-b2b5-ea1d81d55a67' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>167</dd><dt><span>GRIB_dataType :</span></dt><dd>fc</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>405900</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>0</dd><dt><span>GRIB_Nx :</span></dt><dd>900</dd><dt><span>GRIB_Ny :</span></dt><dd>451</dd><dt><span>GRIB_cfName :</span></dt><dd>unknown</dd><dt><span>GRIB_cfVarName :</span></dt><dd>t2m</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.4</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.4</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>90.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>-90.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>-180.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>179.6</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>2 metre temperature</dd><dt><span>GRIB_shortName :</span></dt><dd>2t</dd><dt><span>GRIB_totalNumber :</span></dt><dd>0</dd><dt><span>GRIB_units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>2 metre temperature</dd><dt><span>units :</span></dt><dd>K</dd><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>GRIB_number :</span></dt><dd>0</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><pre>[38966400 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>sp</span></div><div class='xr-var-dims'>(forecast_period, forecast_reference_time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-e90d3a46-0da0-4848-a6d4-4c76037d8f2a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e90d3a46-0da0-4848-a6d4-4c76037d8f2a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b8ba3df3-33e9-4d9e-88e8-8736f6ed652e' class='xr-var-data-in' type='checkbox'><label for='data-b8ba3df3-33e9-4d9e-88e8-8736f6ed652e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>134</dd><dt><span>GRIB_dataType :</span></dt><dd>fc</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>405900</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>0</dd><dt><span>GRIB_Nx :</span></dt><dd>900</dd><dt><span>GRIB_Ny :</span></dt><dd>451</dd><dt><span>GRIB_cfName :</span></dt><dd>surface_air_pressure</dd><dt><span>GRIB_cfVarName :</span></dt><dd>sp</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.4</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.4</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>90.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>-90.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>-180.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>179.6</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>Surface pressure</dd><dt><span>GRIB_shortName :</span></dt><dd>sp</dd><dt><span>GRIB_totalNumber :</span></dt><dd>0</dd><dt><span>GRIB_units :</span></dt><dd>Pa</dd><dt><span>long_name :</span></dt><dd>Surface pressure</dd><dt><span>units :</span></dt><dd>Pa</dd><dt><span>standard_name :</span></dt><dd>surface_air_pressure</dd><dt><span>GRIB_number :</span></dt><dd>0</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><pre>[38966400 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pm2p5</span></div><div class='xr-var-dims'>(forecast_period, forecast_reference_time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-d453f058-d63f-4a5b-9fe2-ef62e21e8ae9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d453f058-d63f-4a5b-9fe2-ef62e21e8ae9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-94b069eb-d93d-48a0-a605-1601cddccfa4' class='xr-var-data-in' type='checkbox'><label for='data-94b069eb-d93d-48a0-a605-1601cddccfa4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>210073</dd><dt><span>GRIB_dataType :</span></dt><dd>fc</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>405900</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>0</dd><dt><span>GRIB_Nx :</span></dt><dd>900</dd><dt><span>GRIB_Ny :</span></dt><dd>451</dd><dt><span>GRIB_cfName :</span></dt><dd>mass_concentration_of_pm2p5_ambient_aerosol_particles_in_air</dd><dt><span>GRIB_cfVarName :</span></dt><dd>pm2p5</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.4</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.4</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>90.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>-90.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>-180.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>179.6</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>Particulate matter d &lt;= 2.5 um</dd><dt><span>GRIB_shortName :</span></dt><dd>pm2p5</dd><dt><span>GRIB_totalNumber :</span></dt><dd>0</dd><dt><span>GRIB_units :</span></dt><dd>kg m**-3</dd><dt><span>long_name :</span></dt><dd>Particulate matter d &lt;= 2.5 um</dd><dt><span>units :</span></dt><dd>kg m**-3</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_pm2p5_ambient_aerosol_particles_in_air</dd><dt><span>GRIB_number :</span></dt><dd>0</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><pre>[38966400 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pm10</span></div><div class='xr-var-dims'>(forecast_period, forecast_reference_time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-7781baa6-9c56-423c-8cc2-0b56e5a2a0ca' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7781baa6-9c56-423c-8cc2-0b56e5a2a0ca' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d194ccb0-0bf5-4414-82ce-6305e05aa2c4' class='xr-var-data-in' type='checkbox'><label for='data-d194ccb0-0bf5-4414-82ce-6305e05aa2c4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>210074</dd><dt><span>GRIB_dataType :</span></dt><dd>fc</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>405900</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>0</dd><dt><span>GRIB_Nx :</span></dt><dd>900</dd><dt><span>GRIB_Ny :</span></dt><dd>451</dd><dt><span>GRIB_cfName :</span></dt><dd>mass_concentration_of_pm10_ambient_aerosol_particles_in_air</dd><dt><span>GRIB_cfVarName :</span></dt><dd>pm10</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.4</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.4</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>90.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>-90.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>-180.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>179.6</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>Particulate matter d &lt;= 10 um</dd><dt><span>GRIB_shortName :</span></dt><dd>pm10</dd><dt><span>GRIB_totalNumber :</span></dt><dd>0</dd><dt><span>GRIB_units :</span></dt><dd>kg m**-3</dd><dt><span>long_name :</span></dt><dd>Particulate matter d &lt;= 10 um</dd><dt><span>units :</span></dt><dd>kg m**-3</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_pm10_ambient_aerosol_particles_in_air</dd><dt><span>GRIB_number :</span></dt><dd>0</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><pre>[38966400 values with dtype=float32]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-7e9ae025-017d-4ad6-a2f0-b4284f5afb15' class='xr-section-summary-in' type='checkbox'  ><label for='section-7e9ae025-017d-4ad6-a2f0-b4284f5afb15' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>forecast_period</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-54d4c959-3db9-4208-bb81-5a582b9f0ae5' class='xr-index-data-in' type='checkbox'/><label for='index-54d4c959-3db9-4208-bb81-5a582b9f0ae5' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(TimedeltaIndex([&#x27;0 days 00:00:00&#x27;, &#x27;0 days 01:00:00&#x27;, &#x27;0 days 02:00:00&#x27;,
                &#x27;0 days 03:00:00&#x27;, &#x27;0 days 04:00:00&#x27;, &#x27;0 days 05:00:00&#x27;,
                &#x27;0 days 06:00:00&#x27;, &#x27;0 days 07:00:00&#x27;, &#x27;0 days 08:00:00&#x27;,
                &#x27;0 days 09:00:00&#x27;, &#x27;0 days 10:00:00&#x27;, &#x27;0 days 11:00:00&#x27;,
                &#x27;0 days 12:00:00&#x27;, &#x27;0 days 13:00:00&#x27;, &#x27;0 days 14:00:00&#x27;,
                &#x27;0 days 15:00:00&#x27;, &#x27;0 days 16:00:00&#x27;, &#x27;0 days 17:00:00&#x27;,
                &#x27;0 days 18:00:00&#x27;, &#x27;0 days 19:00:00&#x27;, &#x27;0 days 20:00:00&#x27;,
                &#x27;0 days 21:00:00&#x27;, &#x27;0 days 22:00:00&#x27;, &#x27;0 days 23:00:00&#x27;,
                &#x27;1 days 00:00:00&#x27;, &#x27;1 days 01:00:00&#x27;, &#x27;1 days 02:00:00&#x27;,
                &#x27;1 days 03:00:00&#x27;, &#x27;1 days 04:00:00&#x27;, &#x27;1 days 05:00:00&#x27;,
                &#x27;1 days 06:00:00&#x27;, &#x27;1 days 07:00:00&#x27;, &#x27;1 days 08:00:00&#x27;,
                &#x27;1 days 09:00:00&#x27;, &#x27;1 days 10:00:00&#x27;, &#x27;1 days 11:00:00&#x27;,
                &#x27;1 days 12:00:00&#x27;, &#x27;1 days 13:00:00&#x27;, &#x27;1 days 14:00:00&#x27;,
                &#x27;1 days 15:00:00&#x27;, &#x27;1 days 16:00:00&#x27;, &#x27;1 days 17:00:00&#x27;,
                &#x27;1 days 18:00:00&#x27;, &#x27;1 days 19:00:00&#x27;, &#x27;1 days 20:00:00&#x27;,
                &#x27;1 days 21:00:00&#x27;, &#x27;1 days 22:00:00&#x27;, &#x27;1 days 23:00:00&#x27;,
                &#x27;2 days 00:00:00&#x27;, &#x27;2 days 01:00:00&#x27;, &#x27;2 days 02:00:00&#x27;,
                &#x27;2 days 03:00:00&#x27;, &#x27;2 days 04:00:00&#x27;, &#x27;2 days 05:00:00&#x27;,
                &#x27;2 days 06:00:00&#x27;, &#x27;2 days 07:00:00&#x27;, &#x27;2 days 08:00:00&#x27;,
                &#x27;2 days 09:00:00&#x27;, &#x27;2 days 10:00:00&#x27;, &#x27;2 days 11:00:00&#x27;,
                &#x27;2 days 12:00:00&#x27;, &#x27;2 days 13:00:00&#x27;, &#x27;2 days 14:00:00&#x27;,
                &#x27;2 days 15:00:00&#x27;, &#x27;2 days 16:00:00&#x27;, &#x27;2 days 17:00:00&#x27;,
                &#x27;2 days 18:00:00&#x27;, &#x27;2 days 19:00:00&#x27;, &#x27;2 days 20:00:00&#x27;,
                &#x27;2 days 21:00:00&#x27;, &#x27;2 days 22:00:00&#x27;, &#x27;2 days 23:00:00&#x27;,
                &#x27;3 days 00:00:00&#x27;, &#x27;3 days 01:00:00&#x27;, &#x27;3 days 02:00:00&#x27;,
                &#x27;3 days 03:00:00&#x27;, &#x27;3 days 04:00:00&#x27;, &#x27;3 days 05:00:00&#x27;,
                &#x27;3 days 06:00:00&#x27;, &#x27;3 days 07:00:00&#x27;, &#x27;3 days 08:00:00&#x27;,
                &#x27;3 days 09:00:00&#x27;, &#x27;3 days 10:00:00&#x27;, &#x27;3 days 11:00:00&#x27;,
                &#x27;3 days 12:00:00&#x27;, &#x27;3 days 13:00:00&#x27;, &#x27;3 days 14:00:00&#x27;,
                &#x27;3 days 15:00:00&#x27;, &#x27;3 days 16:00:00&#x27;, &#x27;3 days 17:00:00&#x27;,
                &#x27;3 days 18:00:00&#x27;, &#x27;3 days 19:00:00&#x27;, &#x27;3 days 20:00:00&#x27;,
                &#x27;3 days 21:00:00&#x27;, &#x27;3 days 22:00:00&#x27;, &#x27;3 days 23:00:00&#x27;],
               dtype=&#x27;timedelta64[ns]&#x27;, name=&#x27;forecast_period&#x27;, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>forecast_reference_time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-d6fb22ee-10bc-4342-beff-bbc425448fe5' class='xr-index-data-in' type='checkbox'/><label for='index-d6fb22ee-10bc-4342-beff-bbc425448fe5' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2024-10-03&#x27;], dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;forecast_reference_time&#x27;, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-78f0b580-bbcf-4507-8c11-22b0fc45c487' class='xr-index-data-in' type='checkbox'/><label for='index-78f0b580-bbcf-4507-8c11-22b0fc45c487' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([              90.0,               89.6,  89.19999999999999,
        88.79999999999998,  88.39999999999998,  87.99999999999997,
        87.59999999999997,  87.19999999999996,  86.79999999999995,
        86.39999999999995,
       ...
       -86.40000000000036, -86.80000000000037, -87.20000000000037,
       -87.60000000000038, -88.00000000000038, -88.40000000000039,
        -88.8000000000004,  -89.2000000000004,  -89.6000000000004,
                    -90.0],
      dtype=&#x27;float64&#x27;, name=&#x27;latitude&#x27;, length=451))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>longitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-ee079099-9445-4519-898b-1b6ea7ff279b' class='xr-index-data-in' type='checkbox'/><label for='index-ee079099-9445-4519-898b-1b6ea7ff279b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([             -180.0,              -179.6,              -179.2,
       -178.79999999999998, -178.39999999999998, -177.99999999999997,
       -177.59999999999997, -177.19999999999996, -176.79999999999995,
       -176.39999999999995,
       ...
         176.0000000000029,   176.4000000000029,   176.8000000000029,
        177.20000000000292,  177.60000000000292,  178.00000000000293,
        178.40000000000293,  178.80000000000294,  179.20000000000294,
                     179.6],
      dtype=&#x27;float64&#x27;, name=&#x27;longitude&#x27;, length=900))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d96132a1-9df1-4756-ac4b-259ade47ea20' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d96132a1-9df1-4756-ac4b-259ade47ea20' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>GRIB_centre :</span></dt><dd>ecmf</dd><dt><span>GRIB_centreDescription :</span></dt><dd>European Centre for Medium-Range Weather Forecasts</dd><dt><span>GRIB_subCentre :</span></dt><dd>0</dd><dt><span>Conventions :</span></dt><dd>CF-1.7</dd><dt><span>institution :</span></dt><dd>European Centre for Medium-Range Weather Forecasts</dd><dt><span>history :</span></dt><dd>2024-10-04T07:51 GRIB to CDM+CF via cfgrib-0.9.14.1/ecCodes-2.36.0 with {&quot;source&quot;: &quot;data.grib&quot;, &quot;filter_by_keys&quot;: {&quot;typeOfLevel&quot;: &quot;surface&quot;}, &quot;encode_cf&quot;: [&quot;parameter&quot;, &quot;time&quot;, &quot;geography&quot;, &quot;vertical&quot;]}</dd></dl></div></li></ul></div></div></div></div>
</div>
</section>
<section id="trace-gases">
<h2>Trace gases<a class="headerlink" href="#trace-gases" title="Permalink to this heading">#</a></h2>
<p>The concentration of the trace gases is provided as mixing ratio, a dimensionless quantity that represents the ratio between the mass concentration of the trace gas, in kg per unit volume, and the mass concentration of air.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">multi_level_ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATADIR</span><span class="si">}</span><span class="s1">/data_mlev.nc&#39;</span><span class="p">)</span> 
<span class="n">multi_level_ds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 156MB
Dimensions:                  (forecast_period: 32, forecast_reference_time: 1,
                              model_level: 1, latitude: 451, longitude: 900)
Coordinates:
  * forecast_period          (forecast_period) timedelta64[ns] 256B 00:00:00 ...
  * forecast_reference_time  (forecast_reference_time) datetime64[ns] 8B 2024...
  * model_level              (model_level) float64 8B 137.0
  * latitude                 (latitude) float64 4kB 90.0 89.6 ... -89.6 -90.0
  * longitude                (longitude) float64 7kB -180.0 -179.6 ... 179.6
    valid_time               (forecast_reference_time, forecast_period) datetime64[ns] 256B ...
Data variables:
    no2                      (forecast_period, forecast_reference_time, model_level, latitude, longitude) float32 52MB ...
    go3                      (forecast_period, forecast_reference_time, model_level, latitude, longitude) float32 52MB ...
    so2                      (forecast_period, forecast_reference_time, model_level, latitude, longitude) float32 52MB ...
Attributes:
    GRIB_centre:             ecmf
    GRIB_centreDescription:  European Centre for Medium-Range Weather Forecasts
    GRIB_subCentre:          0
    Conventions:             CF-1.7
    institution:             European Centre for Medium-Range Weather Forecasts
    history:                 2024-10-04T07:51 GRIB to CDM+CF via cfgrib-0.9.1...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-83fa21c5-6024-44f8-9a26-0f2f7964bc9b' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-83fa21c5-6024-44f8-9a26-0f2f7964bc9b' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>forecast_period</span>: 32</li><li><span class='xr-has-index'>forecast_reference_time</span>: 1</li><li><span class='xr-has-index'>model_level</span>: 1</li><li><span class='xr-has-index'>latitude</span>: 451</li><li><span class='xr-has-index'>longitude</span>: 900</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-fd1169f1-4bbb-4ee4-8677-2b5cb1a99fa9' class='xr-section-summary-in' type='checkbox'  checked><label for='section-fd1169f1-4bbb-4ee4-8677-2b5cb1a99fa9' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>forecast_period</span></div><div class='xr-var-dims'>(forecast_period)</div><div class='xr-var-dtype'>timedelta64[ns]</div><div class='xr-var-preview xr-preview'>0 days 00:00:00 ... 3 days 21:00:00</div><input id='attrs-f1723ae5-5904-4d09-ae87-a723b8647da5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f1723ae5-5904-4d09-ae87-a723b8647da5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-98756d27-3a93-4f7d-9487-84ed16c3ce82' class='xr-var-data-in' type='checkbox'><label for='data-98756d27-3a93-4f7d-9487-84ed16c3ce82' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time since forecast_reference_time</dd><dt><span>standard_name :</span></dt><dd>forecast_period</dd></dl></div><div class='xr-var-data'><pre>array([              0,  10800000000000,  21600000000000,  32400000000000,
        43200000000000,  54000000000000,  64800000000000,  75600000000000,
        86400000000000,  97200000000000, 108000000000000, 118800000000000,
       129600000000000, 140400000000000, 151200000000000, 162000000000000,
       172800000000000, 183600000000000, 194400000000000, 205200000000000,
       216000000000000, 226800000000000, 237600000000000, 248400000000000,
       259200000000000, 270000000000000, 280800000000000, 291600000000000,
       302400000000000, 313200000000000, 324000000000000, 334800000000000],
      dtype=&#x27;timedelta64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>forecast_reference_time</span></div><div class='xr-var-dims'>(forecast_reference_time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2024-10-03</div><input id='attrs-67b992ec-df5e-4028-afb1-9583c5e215c3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-67b992ec-df5e-4028-afb1-9583c5e215c3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5233381d-a67b-46b9-9c88-a57ca7c80ed2' class='xr-var-data-in' type='checkbox'><label for='data-5233381d-a67b-46b9-9c88-a57ca7c80ed2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>initial time of forecast</dd><dt><span>standard_name :</span></dt><dd>forecast_reference_time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2024-10-03T00:00:00.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>model_level</span></div><div class='xr-var-dims'>(model_level)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>137.0</div><input id='attrs-f5e28180-8164-4424-81c2-f417400abfcd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f5e28180-8164-4424-81c2-f417400abfcd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-355f1eaf-fd3c-4cda-b002-a0dfa9a4075a' class='xr-var-data-in' type='checkbox'><label for='data-355f1eaf-fd3c-4cda-b002-a0dfa9a4075a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>hybrid level</dd><dt><span>units :</span></dt><dd>1</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>standard_name :</span></dt><dd>atmosphere_hybrid_sigma_pressure_coordinate</dd></dl></div><div class='xr-var-data'><pre>array([137.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>90.0 89.6 89.2 ... -89.6 -90.0</div><input id='attrs-65eb05dd-4a9b-4796-b719-f83833b374cc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-65eb05dd-4a9b-4796-b719-f83833b374cc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d7cba251-d687-4b44-be02-d7c4549f954b' class='xr-var-data-in' type='checkbox'><label for='data-d7cba251-d687-4b44-be02-d7c4549f954b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>stored_direction :</span></dt><dd>decreasing</dd></dl></div><div class='xr-var-data'><pre>array([ 90. ,  89.6,  89.2, ..., -89.2, -89.6, -90. ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-180.0 -179.6 ... 179.2 179.6</div><input id='attrs-5e49ed5d-ee2f-4fb6-a5e1-65c73c080771' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5e49ed5d-ee2f-4fb6-a5e1-65c73c080771' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-76ca8b29-21bf-4555-b659-049300743984' class='xr-var-data-in' type='checkbox'><label for='data-76ca8b29-21bf-4555-b659-049300743984' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-180. , -179.6, -179.2, ...,  178.8,  179.2,  179.6])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>valid_time</span></div><div class='xr-var-dims'>(forecast_reference_time, forecast_period)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-24d94764-0dc1-4bb2-94fb-04a28537ddd5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-24d94764-0dc1-4bb2-94fb-04a28537ddd5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-39fbed8d-be6a-46a6-9433-1b2ab573c916' class='xr-var-data-in' type='checkbox'><label for='data-39fbed8d-be6a-46a6-9433-1b2ab573c916' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>[32 values with dtype=datetime64[ns]]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-217716a2-0ff0-4b64-875a-b97b31fa7818' class='xr-section-summary-in' type='checkbox'  checked><label for='section-217716a2-0ff0-4b64-875a-b97b31fa7818' class='xr-section-summary' >Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>no2</span></div><div class='xr-var-dims'>(forecast_period, forecast_reference_time, model_level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-4e7eb9de-07d2-4313-8cdf-4893ab7bad8e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4e7eb9de-07d2-4313-8cdf-4893ab7bad8e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0e0c285b-6f28-46d4-8661-d2983e5b46a4' class='xr-var-data-in' type='checkbox'><label for='data-0e0c285b-6f28-46d4-8661-d2983e5b46a4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>210121</dd><dt><span>GRIB_dataType :</span></dt><dd>fc</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>405900</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>hybrid</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>276</dd><dt><span>GRIB_Nx :</span></dt><dd>900</dd><dt><span>GRIB_Ny :</span></dt><dd>451</dd><dt><span>GRIB_cfName :</span></dt><dd>mass_fraction_of_nitrogen_dioxide_in_air</dd><dt><span>GRIB_cfVarName :</span></dt><dd>no2</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/longitude</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.4</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.4</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>90.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>-90.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>180.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>179.6</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>Nitrogen dioxide mass mixing ratio</dd><dt><span>GRIB_pv :</span></dt><dd>[0.00000000e+00 2.00036502e+00 3.10224104e+00 4.66608381e+00
 6.82797718e+00 9.74696636e+00 1.36054239e+01 1.86089306e+01
 2.49857178e+01 3.29857101e+01 4.28792419e+01 5.49554634e+01
 6.95205765e+01 8.68958817e+01 1.07415741e+02 1.31425507e+02
 1.59279404e+02 1.91338562e+02 2.27968948e+02 2.69539581e+02
 3.16420746e+02 3.68982361e+02 4.27592499e+02 4.92616028e+02
 5.64413452e+02 6.43339905e+02 7.29744141e+02 8.23967834e+02
 9.26344910e+02 1.03720117e+03 1.15685364e+03 1.28561035e+03
 1.42377014e+03 1.57162292e+03 1.72944897e+03 1.89751929e+03
 2.07609595e+03 2.26543164e+03 2.46577051e+03 2.67734814e+03
 2.90039136e+03 3.13511938e+03 3.38174365e+03 3.64046826e+03
 3.91149048e+03 4.19493066e+03 4.49081738e+03 4.79914941e+03
 5.11989502e+03 5.45299072e+03 5.79834473e+03 6.15607422e+03
 6.52694678e+03 6.91187061e+03 7.31186914e+03 7.72741211e+03
 8.15935400e+03 8.60852539e+03 9.07640039e+03 9.56268262e+03
 1.00659785e+04 1.05846318e+04 1.11166621e+04 1.16600674e+04
 1.22115479e+04 1.27668730e+04 1.33246689e+04 1.38813311e+04
 1.44321396e+04 1.49756152e+04 1.55082568e+04 1.60261152e+04
 1.65273223e+04 1.70087891e+04 1.74676133e+04 1.79016211e+04
 1.83084336e+04 1.86857188e+04 1.90312891e+04 1.93435117e+04
 1.96200430e+04 1.98593906e+04 2.00599316e+04 2.02196641e+04
 2.03378633e+04 2.04123086e+04 2.04420781e+04 2.04257188e+04
 2.03618164e+04 2.02495117e+04 2.00870859e+04 1.98740254e+04
 1.96085723e+04 1.92902266e+04 1.89174609e+04 1.84897070e+04
 1.80069258e+04 1.74718398e+04 1.68886875e+04 1.62620469e+04
 1.55966953e+04 1.48984531e+04 1.41733242e+04 1.34277695e+04
 1.26682578e+04 1.19013398e+04 1.11333047e+04 1.03701758e+04
 9.61751562e+03 8.88045312e+03 8.16337500e+03 7.47034375e+03
 6.80442188e+03 6.16853125e+03 5.56438281e+03 4.99379688e+03
 4.45737500e+03 3.95596094e+03 3.48923438e+03 3.05726562e+03
 2.65914062e+03 2.29424219e+03 1.96150000e+03 1.65947656e+03
 1.38754688e+03 1.14325000e+03 9.26507812e+02 7.34992188e+02
 5.68062500e+02 4.24414062e+02 3.02476562e+02 2.02484375e+02
 1.22101562e+02 6.27812500e+01 2.28359375e+01 3.75781298e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 3.81999996e-08 6.76070022e-06 2.43480008e-05 5.89219999e-05
 1.11914298e-04 1.98577400e-04 3.40379687e-04 5.61555324e-04
 8.89697927e-04 1.35280553e-03 1.99183798e-03 2.85712420e-03
 3.97095364e-03 5.37781464e-03 7.13337678e-03 9.26146004e-03
 1.18060224e-02 1.48156285e-02 1.83184519e-02 2.23548450e-02
 2.69635208e-02 3.21760960e-02 3.80263999e-02 4.45479602e-02
 5.17730154e-02 5.97284138e-02 6.84482530e-02 7.79583082e-02
 8.82857367e-02 9.94616672e-02 1.11504652e-01 1.24448128e-01
 1.38312891e-01 1.53125033e-01 1.68910414e-01 1.85689449e-01
 2.03491211e-01 2.22332865e-01 2.42244005e-01 2.63241887e-01
 2.85354018e-01 3.08598459e-01 3.32939088e-01 3.58254194e-01
 3.84363323e-01 4.11124766e-01 4.38391209e-01 4.66003299e-01
 4.93800312e-01 5.21619201e-01 5.49301147e-01 5.76692164e-01
 6.03648067e-01 6.30035818e-01 6.55735970e-01 6.80643022e-01
 7.04668999e-01 7.27738738e-01 7.49796569e-01 7.70797551e-01
 7.90716767e-01 8.09536040e-01 8.27256083e-01 8.43881130e-01
 8.59431803e-01 8.73929262e-01 8.87407541e-01 8.99900496e-01
 9.11448181e-01 9.22095656e-01 9.31880772e-01 9.40859556e-01
 9.49064434e-01 9.56549525e-01 9.63351727e-01 9.69513416e-01
 9.75078404e-01 9.80071604e-01 9.84541893e-01 9.88499522e-01
 9.91984010e-01 9.95002508e-01 9.97630119e-01 1.00000000e+00]</dd><dt><span>GRIB_shortName :</span></dt><dd>no2</dd><dt><span>GRIB_units :</span></dt><dd>kg kg**-1</dd><dt><span>long_name :</span></dt><dd>Nitrogen dioxide mass mixing ratio</dd><dt><span>units :</span></dt><dd>kg kg**-1</dd><dt><span>standard_name :</span></dt><dd>mass_fraction_of_nitrogen_dioxide_in_air</dd></dl></div><div class='xr-var-data'><pre>[12988800 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>go3</span></div><div class='xr-var-dims'>(forecast_period, forecast_reference_time, model_level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-c2dbdb52-e8c6-42e3-baf6-4591250b02db' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c2dbdb52-e8c6-42e3-baf6-4591250b02db' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f83286ea-7a70-4cd6-ab74-192fa5a4df8e' class='xr-var-data-in' type='checkbox'><label for='data-f83286ea-7a70-4cd6-ab74-192fa5a4df8e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>210203</dd><dt><span>GRIB_dataType :</span></dt><dd>fc</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>405900</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>hybrid</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>276</dd><dt><span>GRIB_Nx :</span></dt><dd>900</dd><dt><span>GRIB_Ny :</span></dt><dd>451</dd><dt><span>GRIB_cfName :</span></dt><dd>mass_fraction_of_ozone_in_air</dd><dt><span>GRIB_cfVarName :</span></dt><dd>go3</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/longitude</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.4</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.4</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>90.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>-90.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>180.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>179.6</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>Ozone mass mixing ratio (full chemistry scheme)</dd><dt><span>GRIB_pv :</span></dt><dd>[0.00000000e+00 2.00036502e+00 3.10224104e+00 4.66608381e+00
 6.82797718e+00 9.74696636e+00 1.36054239e+01 1.86089306e+01
 2.49857178e+01 3.29857101e+01 4.28792419e+01 5.49554634e+01
 6.95205765e+01 8.68958817e+01 1.07415741e+02 1.31425507e+02
 1.59279404e+02 1.91338562e+02 2.27968948e+02 2.69539581e+02
 3.16420746e+02 3.68982361e+02 4.27592499e+02 4.92616028e+02
 5.64413452e+02 6.43339905e+02 7.29744141e+02 8.23967834e+02
 9.26344910e+02 1.03720117e+03 1.15685364e+03 1.28561035e+03
 1.42377014e+03 1.57162292e+03 1.72944897e+03 1.89751929e+03
 2.07609595e+03 2.26543164e+03 2.46577051e+03 2.67734814e+03
 2.90039136e+03 3.13511938e+03 3.38174365e+03 3.64046826e+03
 3.91149048e+03 4.19493066e+03 4.49081738e+03 4.79914941e+03
 5.11989502e+03 5.45299072e+03 5.79834473e+03 6.15607422e+03
 6.52694678e+03 6.91187061e+03 7.31186914e+03 7.72741211e+03
 8.15935400e+03 8.60852539e+03 9.07640039e+03 9.56268262e+03
 1.00659785e+04 1.05846318e+04 1.11166621e+04 1.16600674e+04
 1.22115479e+04 1.27668730e+04 1.33246689e+04 1.38813311e+04
 1.44321396e+04 1.49756152e+04 1.55082568e+04 1.60261152e+04
 1.65273223e+04 1.70087891e+04 1.74676133e+04 1.79016211e+04
 1.83084336e+04 1.86857188e+04 1.90312891e+04 1.93435117e+04
 1.96200430e+04 1.98593906e+04 2.00599316e+04 2.02196641e+04
 2.03378633e+04 2.04123086e+04 2.04420781e+04 2.04257188e+04
 2.03618164e+04 2.02495117e+04 2.00870859e+04 1.98740254e+04
 1.96085723e+04 1.92902266e+04 1.89174609e+04 1.84897070e+04
 1.80069258e+04 1.74718398e+04 1.68886875e+04 1.62620469e+04
 1.55966953e+04 1.48984531e+04 1.41733242e+04 1.34277695e+04
 1.26682578e+04 1.19013398e+04 1.11333047e+04 1.03701758e+04
 9.61751562e+03 8.88045312e+03 8.16337500e+03 7.47034375e+03
 6.80442188e+03 6.16853125e+03 5.56438281e+03 4.99379688e+03
 4.45737500e+03 3.95596094e+03 3.48923438e+03 3.05726562e+03
 2.65914062e+03 2.29424219e+03 1.96150000e+03 1.65947656e+03
 1.38754688e+03 1.14325000e+03 9.26507812e+02 7.34992188e+02
 5.68062500e+02 4.24414062e+02 3.02476562e+02 2.02484375e+02
 1.22101562e+02 6.27812500e+01 2.28359375e+01 3.75781298e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 3.81999996e-08 6.76070022e-06 2.43480008e-05 5.89219999e-05
 1.11914298e-04 1.98577400e-04 3.40379687e-04 5.61555324e-04
 8.89697927e-04 1.35280553e-03 1.99183798e-03 2.85712420e-03
 3.97095364e-03 5.37781464e-03 7.13337678e-03 9.26146004e-03
 1.18060224e-02 1.48156285e-02 1.83184519e-02 2.23548450e-02
 2.69635208e-02 3.21760960e-02 3.80263999e-02 4.45479602e-02
 5.17730154e-02 5.97284138e-02 6.84482530e-02 7.79583082e-02
 8.82857367e-02 9.94616672e-02 1.11504652e-01 1.24448128e-01
 1.38312891e-01 1.53125033e-01 1.68910414e-01 1.85689449e-01
 2.03491211e-01 2.22332865e-01 2.42244005e-01 2.63241887e-01
 2.85354018e-01 3.08598459e-01 3.32939088e-01 3.58254194e-01
 3.84363323e-01 4.11124766e-01 4.38391209e-01 4.66003299e-01
 4.93800312e-01 5.21619201e-01 5.49301147e-01 5.76692164e-01
 6.03648067e-01 6.30035818e-01 6.55735970e-01 6.80643022e-01
 7.04668999e-01 7.27738738e-01 7.49796569e-01 7.70797551e-01
 7.90716767e-01 8.09536040e-01 8.27256083e-01 8.43881130e-01
 8.59431803e-01 8.73929262e-01 8.87407541e-01 8.99900496e-01
 9.11448181e-01 9.22095656e-01 9.31880772e-01 9.40859556e-01
 9.49064434e-01 9.56549525e-01 9.63351727e-01 9.69513416e-01
 9.75078404e-01 9.80071604e-01 9.84541893e-01 9.88499522e-01
 9.91984010e-01 9.95002508e-01 9.97630119e-01 1.00000000e+00]</dd><dt><span>GRIB_shortName :</span></dt><dd>go3</dd><dt><span>GRIB_units :</span></dt><dd>kg kg**-1</dd><dt><span>long_name :</span></dt><dd>Ozone mass mixing ratio (full chemistry scheme)</dd><dt><span>units :</span></dt><dd>kg kg**-1</dd><dt><span>standard_name :</span></dt><dd>mass_fraction_of_ozone_in_air</dd></dl></div><div class='xr-var-data'><pre>[12988800 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>so2</span></div><div class='xr-var-dims'>(forecast_period, forecast_reference_time, model_level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-e8d70f97-d418-4365-a27a-ceb5228f4cc1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e8d70f97-d418-4365-a27a-ceb5228f4cc1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-31388329-98dc-4ca6-af4d-c81e91be7697' class='xr-var-data-in' type='checkbox'><label for='data-31388329-98dc-4ca6-af4d-c81e91be7697' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>210122</dd><dt><span>GRIB_dataType :</span></dt><dd>fc</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>405900</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>hybrid</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>276</dd><dt><span>GRIB_Nx :</span></dt><dd>900</dd><dt><span>GRIB_Ny :</span></dt><dd>451</dd><dt><span>GRIB_cfName :</span></dt><dd>mass_fraction_of_sulfur_dioxide_in_air</dd><dt><span>GRIB_cfVarName :</span></dt><dd>so2</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/longitude</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.4</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.4</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>90.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>-90.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>180.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>179.6</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>Sulphur dioxide mass mixing ratio</dd><dt><span>GRIB_pv :</span></dt><dd>[0.00000000e+00 2.00036502e+00 3.10224104e+00 4.66608381e+00
 6.82797718e+00 9.74696636e+00 1.36054239e+01 1.86089306e+01
 2.49857178e+01 3.29857101e+01 4.28792419e+01 5.49554634e+01
 6.95205765e+01 8.68958817e+01 1.07415741e+02 1.31425507e+02
 1.59279404e+02 1.91338562e+02 2.27968948e+02 2.69539581e+02
 3.16420746e+02 3.68982361e+02 4.27592499e+02 4.92616028e+02
 5.64413452e+02 6.43339905e+02 7.29744141e+02 8.23967834e+02
 9.26344910e+02 1.03720117e+03 1.15685364e+03 1.28561035e+03
 1.42377014e+03 1.57162292e+03 1.72944897e+03 1.89751929e+03
 2.07609595e+03 2.26543164e+03 2.46577051e+03 2.67734814e+03
 2.90039136e+03 3.13511938e+03 3.38174365e+03 3.64046826e+03
 3.91149048e+03 4.19493066e+03 4.49081738e+03 4.79914941e+03
 5.11989502e+03 5.45299072e+03 5.79834473e+03 6.15607422e+03
 6.52694678e+03 6.91187061e+03 7.31186914e+03 7.72741211e+03
 8.15935400e+03 8.60852539e+03 9.07640039e+03 9.56268262e+03
 1.00659785e+04 1.05846318e+04 1.11166621e+04 1.16600674e+04
 1.22115479e+04 1.27668730e+04 1.33246689e+04 1.38813311e+04
 1.44321396e+04 1.49756152e+04 1.55082568e+04 1.60261152e+04
 1.65273223e+04 1.70087891e+04 1.74676133e+04 1.79016211e+04
 1.83084336e+04 1.86857188e+04 1.90312891e+04 1.93435117e+04
 1.96200430e+04 1.98593906e+04 2.00599316e+04 2.02196641e+04
 2.03378633e+04 2.04123086e+04 2.04420781e+04 2.04257188e+04
 2.03618164e+04 2.02495117e+04 2.00870859e+04 1.98740254e+04
 1.96085723e+04 1.92902266e+04 1.89174609e+04 1.84897070e+04
 1.80069258e+04 1.74718398e+04 1.68886875e+04 1.62620469e+04
 1.55966953e+04 1.48984531e+04 1.41733242e+04 1.34277695e+04
 1.26682578e+04 1.19013398e+04 1.11333047e+04 1.03701758e+04
 9.61751562e+03 8.88045312e+03 8.16337500e+03 7.47034375e+03
 6.80442188e+03 6.16853125e+03 5.56438281e+03 4.99379688e+03
 4.45737500e+03 3.95596094e+03 3.48923438e+03 3.05726562e+03
 2.65914062e+03 2.29424219e+03 1.96150000e+03 1.65947656e+03
 1.38754688e+03 1.14325000e+03 9.26507812e+02 7.34992188e+02
 5.68062500e+02 4.24414062e+02 3.02476562e+02 2.02484375e+02
 1.22101562e+02 6.27812500e+01 2.28359375e+01 3.75781298e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 3.81999996e-08 6.76070022e-06 2.43480008e-05 5.89219999e-05
 1.11914298e-04 1.98577400e-04 3.40379687e-04 5.61555324e-04
 8.89697927e-04 1.35280553e-03 1.99183798e-03 2.85712420e-03
 3.97095364e-03 5.37781464e-03 7.13337678e-03 9.26146004e-03
 1.18060224e-02 1.48156285e-02 1.83184519e-02 2.23548450e-02
 2.69635208e-02 3.21760960e-02 3.80263999e-02 4.45479602e-02
 5.17730154e-02 5.97284138e-02 6.84482530e-02 7.79583082e-02
 8.82857367e-02 9.94616672e-02 1.11504652e-01 1.24448128e-01
 1.38312891e-01 1.53125033e-01 1.68910414e-01 1.85689449e-01
 2.03491211e-01 2.22332865e-01 2.42244005e-01 2.63241887e-01
 2.85354018e-01 3.08598459e-01 3.32939088e-01 3.58254194e-01
 3.84363323e-01 4.11124766e-01 4.38391209e-01 4.66003299e-01
 4.93800312e-01 5.21619201e-01 5.49301147e-01 5.76692164e-01
 6.03648067e-01 6.30035818e-01 6.55735970e-01 6.80643022e-01
 7.04668999e-01 7.27738738e-01 7.49796569e-01 7.70797551e-01
 7.90716767e-01 8.09536040e-01 8.27256083e-01 8.43881130e-01
 8.59431803e-01 8.73929262e-01 8.87407541e-01 8.99900496e-01
 9.11448181e-01 9.22095656e-01 9.31880772e-01 9.40859556e-01
 9.49064434e-01 9.56549525e-01 9.63351727e-01 9.69513416e-01
 9.75078404e-01 9.80071604e-01 9.84541893e-01 9.88499522e-01
 9.91984010e-01 9.95002508e-01 9.97630119e-01 1.00000000e+00]</dd><dt><span>GRIB_shortName :</span></dt><dd>so2</dd><dt><span>GRIB_units :</span></dt><dd>kg kg**-1</dd><dt><span>long_name :</span></dt><dd>Sulphur dioxide mass mixing ratio</dd><dt><span>units :</span></dt><dd>kg kg**-1</dd><dt><span>standard_name :</span></dt><dd>mass_fraction_of_sulfur_dioxide_in_air</dd></dl></div><div class='xr-var-data'><pre>[12988800 values with dtype=float32]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3ed92864-31df-4760-84c0-259e9d002f09' class='xr-section-summary-in' type='checkbox'  ><label for='section-3ed92864-31df-4760-84c0-259e9d002f09' class='xr-section-summary' >Indexes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>forecast_period</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-f2b66d04-925b-4fe2-bc54-398930f20d4f' class='xr-index-data-in' type='checkbox'/><label for='index-f2b66d04-925b-4fe2-bc54-398930f20d4f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(TimedeltaIndex([&#x27;0 days 00:00:00&#x27;, &#x27;0 days 03:00:00&#x27;, &#x27;0 days 06:00:00&#x27;,
                &#x27;0 days 09:00:00&#x27;, &#x27;0 days 12:00:00&#x27;, &#x27;0 days 15:00:00&#x27;,
                &#x27;0 days 18:00:00&#x27;, &#x27;0 days 21:00:00&#x27;, &#x27;1 days 00:00:00&#x27;,
                &#x27;1 days 03:00:00&#x27;, &#x27;1 days 06:00:00&#x27;, &#x27;1 days 09:00:00&#x27;,
                &#x27;1 days 12:00:00&#x27;, &#x27;1 days 15:00:00&#x27;, &#x27;1 days 18:00:00&#x27;,
                &#x27;1 days 21:00:00&#x27;, &#x27;2 days 00:00:00&#x27;, &#x27;2 days 03:00:00&#x27;,
                &#x27;2 days 06:00:00&#x27;, &#x27;2 days 09:00:00&#x27;, &#x27;2 days 12:00:00&#x27;,
                &#x27;2 days 15:00:00&#x27;, &#x27;2 days 18:00:00&#x27;, &#x27;2 days 21:00:00&#x27;,
                &#x27;3 days 00:00:00&#x27;, &#x27;3 days 03:00:00&#x27;, &#x27;3 days 06:00:00&#x27;,
                &#x27;3 days 09:00:00&#x27;, &#x27;3 days 12:00:00&#x27;, &#x27;3 days 15:00:00&#x27;,
                &#x27;3 days 18:00:00&#x27;, &#x27;3 days 21:00:00&#x27;],
               dtype=&#x27;timedelta64[ns]&#x27;, name=&#x27;forecast_period&#x27;, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>forecast_reference_time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-a5b383db-1299-405a-90bc-93cd7e3a7f93' class='xr-index-data-in' type='checkbox'/><label for='index-a5b383db-1299-405a-90bc-93cd7e3a7f93' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2024-10-03&#x27;], dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;forecast_reference_time&#x27;, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>model_level</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-9dae6277-5658-4bdc-8b71-3201e01a5191' class='xr-index-data-in' type='checkbox'/><label for='index-9dae6277-5658-4bdc-8b71-3201e01a5191' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([137.0], dtype=&#x27;float64&#x27;, name=&#x27;model_level&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-70e8eb96-fa39-47c3-aa9e-4120d0a0e8d7' class='xr-index-data-in' type='checkbox'/><label for='index-70e8eb96-fa39-47c3-aa9e-4120d0a0e8d7' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([              90.0,               89.6,  89.19999999999999,
        88.79999999999998,  88.39999999999998,  87.99999999999997,
        87.59999999999997,  87.19999999999996,  86.79999999999995,
        86.39999999999995,
       ...
       -86.40000000000036, -86.80000000000037, -87.20000000000037,
       -87.60000000000038, -88.00000000000038, -88.40000000000039,
        -88.8000000000004,  -89.2000000000004,  -89.6000000000004,
                    -90.0],
      dtype=&#x27;float64&#x27;, name=&#x27;latitude&#x27;, length=451))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>longitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-7e6b4092-d487-4256-9cee-88d5b5eef94d' class='xr-index-data-in' type='checkbox'/><label for='index-7e6b4092-d487-4256-9cee-88d5b5eef94d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([             -180.0,              -179.6,              -179.2,
       -178.79999999999998, -178.39999999999998, -177.99999999999997,
       -177.59999999999997, -177.19999999999996, -176.79999999999995,
       -176.39999999999995,
       ...
         176.0000000000029,   176.4000000000029,   176.8000000000029,
        177.20000000000292,  177.60000000000292,  178.00000000000293,
        178.40000000000293,  178.80000000000294,  179.20000000000294,
                     179.6],
      dtype=&#x27;float64&#x27;, name=&#x27;longitude&#x27;, length=900))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-0ab93190-b55d-4e04-8ba1-d4d2339e04da' class='xr-section-summary-in' type='checkbox'  checked><label for='section-0ab93190-b55d-4e04-8ba1-d4d2339e04da' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>GRIB_centre :</span></dt><dd>ecmf</dd><dt><span>GRIB_centreDescription :</span></dt><dd>European Centre for Medium-Range Weather Forecasts</dd><dt><span>GRIB_subCentre :</span></dt><dd>0</dd><dt><span>Conventions :</span></dt><dd>CF-1.7</dd><dt><span>institution :</span></dt><dd>European Centre for Medium-Range Weather Forecasts</dd><dt><span>history :</span></dt><dd>2024-10-04T07:51 GRIB to CDM+CF via cfgrib-0.9.14.1/ecCodes-2.36.0 with {&quot;source&quot;: &quot;data.grib&quot;, &quot;filter_by_keys&quot;: {&quot;typeOfLevel&quot;: &quot;hybrid&quot;}, &quot;encode_cf&quot;: [&quot;parameter&quot;, &quot;time&quot;, &quot;geography&quot;, &quot;vertical&quot;]}</dd></dl></div></li></ul></div></div></div></div>
</div>
</section>
<section id="unit-transformation">
<h2>Unit transformation<a class="headerlink" href="#unit-transformation" title="Permalink to this heading">#</a></h2>
<p>We calculate the scaling factor to convert the dimensionless mixing ratios of <span class="math notranslate nohighlight">\(NO_2, SO_2\)</span>, and <span class="math notranslate nohighlight">\(O_3\)</span> from kg/kg to mass density in ug/m3, using the air surface pressure and the temperature. The scaling factor c is defined as</p>
<div class="math notranslate nohighlight">
\[c = \frac{p}{R_aT}\]</div>
<p>where <span class="math notranslate nohighlight">\(R_a\)</span> is the gas constant of dry air, p the pressure and T the temperature. The derivation of the scalar factor is provided in the appendix.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R</span> <span class="o">=</span> <span class="mf">287.08</span>
<span class="n">cfactor</span> <span class="o">=</span> <span class="n">single_level_ds</span><span class="p">[</span><span class="s1">&#39;sp&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">single_level_ds</span><span class="p">[</span><span class="s1">&#39;t2m&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>With the scaling factor we can transform the concentration values of the trace gases into <span class="math notranslate nohighlight">\(kg \cdot m^{-3}\)</span>, the same unit used for the particulate matter. Then, we multiply for <span class="math notranslate nohighlight">\(10^9\)</span> to represent the values in <span class="math notranslate nohighlight">\(\mu g \cdot m^{-3}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trace_gases</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;no2&#39;</span><span class="p">,</span><span class="s1">&#39;go3&#39;</span><span class="p">,</span><span class="s1">&#39;so2&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">gas</span> <span class="ow">in</span> <span class="n">trace_gases</span><span class="p">:</span>
    <span class="n">multi_level_ds</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="n">multi_level_ds</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">*</span> <span class="n">cfactor</span> <span class="o">*</span> <span class="mf">1e9</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">particulate_matter</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;pm2p5&#39;</span><span class="p">,</span><span class="s1">&#39;pm10&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">particulate_matter</span><span class="p">:</span>
    <span class="n">single_level_ds</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="n">single_level_ds</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e9</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="h-max-and-mean-average">
<h2>24h max and mean average<a class="headerlink" href="#h-max-and-mean-average" title="Permalink to this heading">#</a></h2>
<p>We aggregate the data by computing the maximun daily values of the trace gases concentration and mean daily values of the particulate matter concentration.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">multi_level_max</span> <span class="o">=</span> <span class="n">multi_level_ds</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">valid_time</span><span class="o">=</span><span class="s1">&#39;1D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">multi_level_max</span> <span class="o">=</span> <span class="n">multi_level_max</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">single_level_mean</span> <span class="o">=</span> <span class="n">single_level_ds</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">valid_time</span><span class="o">=</span><span class="s1">&#39;1D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">single_level_mean</span> <span class="o">=</span> <span class="n">single_level_mean</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We merge the trace gases and the particulate matter into one multi-dimensional array</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eaqi_daily</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">single_level_mean</span><span class="p">,</span> <span class="n">multi_level_max</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eaqi_daily</span> <span class="o">=</span> <span class="n">eaqi_daily</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">([</span><span class="s2">&quot;t2m&quot;</span><span class="p">,</span> <span class="s2">&quot;sp&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eaqi_daily</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 32MB
Dimensions:     (valid_time: 4, latitude: 451, longitude: 900)
Coordinates:
  * latitude    (latitude) float64 4kB 90.0 89.6 89.2 88.8 ... -89.2 -89.6 -90.0
  * longitude   (longitude) float64 7kB -180.0 -179.6 -179.2 ... 179.2 179.6
  * valid_time  (valid_time) datetime64[ns] 32B 2024-10-03 ... 2024-10-06
Data variables:
    pm2p5       (valid_time, latitude, longitude) float32 6MB 0.424 ... 0.0391
    pm10        (valid_time, latitude, longitude) float32 6MB 0.7998 ... 0.05665
    no2         (valid_time, latitude, longitude) float32 6MB 0.02572 ... 0.0...
    go3         (valid_time, latitude, longitude) float32 6MB 62.84 ... 47.74
    so2         (valid_time, latitude, longitude) float32 6MB 0.02272 ... 0.0...
Attributes:
    GRIB_centre:             ecmf
    GRIB_centreDescription:  European Centre for Medium-Range Weather Forecasts
    GRIB_subCentre:          0
    Conventions:             CF-1.7
    institution:             European Centre for Medium-Range Weather Forecasts
    history:                 2024-10-04T07:51 GRIB to CDM+CF via cfgrib-0.9.1...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-606380f8-0a1c-4f0f-8f4f-4e31c0096a44' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-606380f8-0a1c-4f0f-8f4f-4e31c0096a44' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>valid_time</span>: 4</li><li><span class='xr-has-index'>latitude</span>: 451</li><li><span class='xr-has-index'>longitude</span>: 900</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-4933e1ad-bd45-45e0-88f8-c63566cc9376' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4933e1ad-bd45-45e0-88f8-c63566cc9376' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>90.0 89.6 89.2 ... -89.6 -90.0</div><input id='attrs-1a545372-8f3f-4f7b-9bb0-fbffa1ae508a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1a545372-8f3f-4f7b-9bb0-fbffa1ae508a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1262ee45-5bae-4f2c-8b74-fd5c00b9cfb1' class='xr-var-data-in' type='checkbox'><label for='data-1262ee45-5bae-4f2c-8b74-fd5c00b9cfb1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>stored_direction :</span></dt><dd>decreasing</dd></dl></div><div class='xr-var-data'><pre>array([ 90. ,  89.6,  89.2, ..., -89.2, -89.6, -90. ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-180.0 -179.6 ... 179.2 179.6</div><input id='attrs-6cc35f09-ce39-4848-9e0d-39ec761abc7f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6cc35f09-ce39-4848-9e0d-39ec761abc7f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e9cf3b4d-9498-499c-beae-212fa2fecd0b' class='xr-var-data-in' type='checkbox'><label for='data-e9cf3b4d-9498-499c-beae-212fa2fecd0b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-180. , -179.6, -179.2, ...,  178.8,  179.2,  179.6])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>valid_time</span></div><div class='xr-var-dims'>(valid_time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2024-10-03 ... 2024-10-06</div><input id='attrs-5a17c8fa-accd-4643-8d64-a350e15779b3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5a17c8fa-accd-4643-8d64-a350e15779b3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-71251ae3-c448-4f70-b29e-a0d36551191c' class='xr-var-data-in' type='checkbox'><label for='data-71251ae3-c448-4f70-b29e-a0d36551191c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2024-10-03T00:00:00.000000000&#x27;, &#x27;2024-10-04T00:00:00.000000000&#x27;,
       &#x27;2024-10-05T00:00:00.000000000&#x27;, &#x27;2024-10-06T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1b539ab2-2be6-47b5-9f84-2f0d5af0c815' class='xr-section-summary-in' type='checkbox'  checked><label for='section-1b539ab2-2be6-47b5-9f84-2f0d5af0c815' class='xr-section-summary' >Data variables: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>pm2p5</span></div><div class='xr-var-dims'>(valid_time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.424 0.424 0.424 ... 0.0391 0.0391</div><input id='attrs-34deeb81-8c7f-476d-8559-8cc22e07eedf' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-34deeb81-8c7f-476d-8559-8cc22e07eedf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bffa353b-e874-46b6-8532-2758f18b2174' class='xr-var-data-in' type='checkbox'><label for='data-bffa353b-e874-46b6-8532-2758f18b2174' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[0.42402926, 0.42402926, 0.42402926, ..., 0.42402926,
         0.42402926, 0.42402926],
        [0.47986376, 0.47990632, 0.47994778, ..., 0.47975233,
         0.47979388, 0.4798317 ],
        [0.52601695, 0.52607745, 0.52614605, ..., 0.5257635 ,
         0.52585244, 0.5259329 ],
        ...,
        [0.33153787, 0.33195236, 0.33237275, ..., 0.3303513 ,
         0.3307468 , 0.33114704],
        [0.36120892, 0.36142573, 0.36161628, ..., 0.3606216 ,
         0.3608205 , 0.36101472],
        [0.35523918, 0.35523918, 0.35523918, ..., 0.35523918,
         0.35523918, 0.35523918]],

       [[0.4948691 , 0.4948691 , 0.4948691 , ..., 0.4948691 ,
         0.4948691 , 0.4948691 ],
        [0.47493014, 0.4749147 , 0.47490528, ..., 0.47494912,
         0.47494793, 0.47494432],
        [0.5261437 , 0.52611643, 0.52608806, ..., 0.5261864 ,
         0.52617794, 0.5261556 ],
...
        [0.07410538, 0.07413854, 0.07420368, ..., 0.07397749,
         0.07403552, 0.07405446],
        [0.09883701, 0.09887727, 0.09889621, ..., 0.09878845,
         0.09881687, 0.09882161],
        [0.10661626, 0.10661626, 0.10661626, ..., 0.10661626,
         0.10661626, 0.10661626]],

       [[0.22533298, 0.22533298, 0.22533298, ..., 0.22533298,
         0.22533298, 0.22533298],
        [0.20778023, 0.20761561, 0.20747942, ..., 0.20820063,
         0.20805971, 0.20790577],
        [0.26437375, 0.26409075, 0.26379347, ..., 0.26523468,
         0.2649339 , 0.26466748],
        ...,
        [0.09897482, 0.09923771, 0.09950891, ..., 0.098134  ,
         0.09840282, 0.09871191],
        [0.06789804, 0.06803185, 0.06816449, ..., 0.06748593,
         0.06760672, 0.06776659],
        [0.03909737, 0.03909737, 0.03909737, ..., 0.03909737,
         0.03909737, 0.03909737]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pm10</span></div><div class='xr-var-dims'>(valid_time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.7998 0.7998 ... 0.05665 0.05665</div><input id='attrs-250558b1-8b20-444f-85f7-014171995ba4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-250558b1-8b20-444f-85f7-014171995ba4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-971854d2-0e53-4a2e-b11b-9cdbb6f16ff5' class='xr-var-data-in' type='checkbox'><label for='data-971854d2-0e53-4a2e-b11b-9cdbb6f16ff5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[0.7998069 , 0.7998069 , 0.7998069 , ..., 0.7998069 ,
         0.7998069 , 0.7998069 ],
        [0.8997803 , 0.89978033, 0.8997993 , ..., 0.89974713,
         0.8997898 , 0.89980394],
        [0.96410346, 0.9640985 , 0.9641034 , ..., 0.9640088 ,
         0.9640135 , 0.96409386],
        ...,
        [0.43569174, 0.43624118, 0.43679547, ..., 0.4341712 ,
         0.43468753, 0.43518963],
        [0.47554848, 0.4758043 , 0.47607425, ..., 0.47474316,
         0.4750274 , 0.47526428],
        [0.4678935 , 0.4678935 , 0.4678935 , ..., 0.4678935 ,
         0.4678935 , 0.4678935 ]],

       [[0.9588751 , 0.9588751 , 0.9588751 , ..., 0.9588751 ,
         0.9588751 , 0.9588751 ],
        [0.9027092 , 0.9024627 , 0.9022212 , ..., 0.90332484,
         0.90311664, 0.9028843 ],
        [1.0131416 , 1.0126773 , 1.0122085 , ..., 1.014449  ,
         1.014037  , 1.0135822 ],
...
        [0.09790039, 0.09797144, 0.09803301, ..., 0.09774405,
         0.09776302, 0.09784354],
        [0.1303485 , 0.13035323, 0.13037218, ..., 0.13025375,
         0.13026322, 0.13029166],
        [0.1418214 , 0.1418214 , 0.1418214 , ..., 0.1418214 ,
         0.1418214 , 0.1418214 ]],

       [[0.46152672, 0.46152672, 0.46152672, ..., 0.46152672,
         0.46152672, 0.46152672],
        [0.42764807, 0.42733547, 0.42703703, ..., 0.4285102 ,
         0.42823553, 0.42789438],
        [0.54537565, 0.54480714, 0.5441913 , ..., 0.5470572 ,
         0.546536  , 0.5459677 ],
        ...,
        [0.13888828, 0.13930036, 0.13966039, ..., 0.13781771,
         0.1382014 , 0.1385614 ],
        [0.09613255, 0.09629362, 0.09649254, ..., 0.09557831,
         0.09575832, 0.09592885],
        [0.05665004, 0.05665004, 0.05665004, ..., 0.05665004,
         0.05665004, 0.05665004]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>no2</span></div><div class='xr-var-dims'>(valid_time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.02572 0.02572 ... 0.001571</div><input id='attrs-93859b2e-b304-4f8c-88b7-93aac6564b3d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-93859b2e-b304-4f8c-88b7-93aac6564b3d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fb162f3a-8376-4f59-a094-9bd72760ead3' class='xr-var-data-in' type='checkbox'><label for='data-fb162f3a-8376-4f59-a094-9bd72760ead3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[0.02571744, 0.02571744, 0.02571744, ..., 0.02571744,
         0.02571744, 0.02571744],
        [0.00939877, 0.0093988 , 0.00941748, ..., 0.00936155,
         0.00938016, 0.00938025],
        [0.00970362, 0.00980882, 0.00993003, ..., 0.00966622,
         0.00966634, 0.00968503],
        ...,
        [0.00508824, 0.00511799, 0.00514775, ..., 0.00499906,
         0.00502871, 0.00505849],
        [0.00284331, 0.00284349, 0.00287309, ..., 0.00278402,
         0.00281357, 0.00281375],
        [0.00138861, 0.00138861, 0.00138861, ..., 0.00138861,
         0.00138861, 0.00138861]],

       [[0.02692642, 0.02692642, 0.02692642, ..., 0.02692642,
         0.02692642, 0.02692642],
        [0.01065122, 0.01065132, 0.01063247, ..., 0.01068871,
         0.01068874, 0.01067007],
        [0.00904677, 0.0090652 , 0.00908353, ..., 0.00897279,
         0.00899121, 0.00902828],
...
        [0.00492917, 0.004945  , 0.00496095, ..., 0.00489671,
         0.0049126 , 0.0049285 ],
        [0.00326804, 0.00328375, 0.00329946, ..., 0.00323645,
         0.00325211, 0.00325234],
        [0.00126386, 0.00126386, 0.00126386, ..., 0.00126386,
         0.00126386, 0.00126386]],

       [[0.00555881, 0.00555881, 0.00555881, ..., 0.00555881,
         0.00555881, 0.00555881],
        [0.00548075, 0.00548075, 0.0054808 , ..., 0.00548079,
         0.00548079, 0.00548079],
        [0.00526254, 0.00526267, 0.00526289, ..., 0.00533897,
         0.0053392 , 0.00533933],
        ...,
        [0.00264078, 0.00270195, 0.00276319, ..., 0.00251815,
         0.00257931, 0.00264049],
        [0.00237373, 0.00238933, 0.00242044, ..., 0.00232698,
         0.00234254, 0.00235814],
        [0.00157137, 0.00157137, 0.00157137, ..., 0.00157137,
         0.00157137, 0.00157137]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>go3</span></div><div class='xr-var-dims'>(valid_time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>62.84 62.84 62.84 ... 47.74 47.74</div><input id='attrs-b82ff1e0-84ce-4c25-9eb0-b9ecbc620852' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b82ff1e0-84ce-4c25-9eb0-b9ecbc620852' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-55d2a339-d0ef-4a45-bd58-b45603c5d084' class='xr-var-data-in' type='checkbox'><label for='data-55d2a339-d0ef-4a45-bd58-b45603c5d084' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[62.835228, 62.835228, 62.835228, ..., 62.835228, 62.835228,
         62.835228],
        [62.63174 , 62.63464 , 62.636395, ..., 62.62423 , 62.6273  ,
         62.629242],
        [63.428345, 63.43368 , 63.43788 , ..., 63.413666, 63.41873 ,
         63.423576],
        ...,
        [54.033035, 54.036648, 54.040627, ..., 54.022366, 54.025894,
         54.02945 ],
        [54.821968, 54.82417 , 54.826344, ..., 54.81709 , 54.818443,
         54.820614],
        [55.22543 , 55.22543 , 55.22543 , ..., 55.22543 , 55.22543 ,
         55.22543 ]],

       [[82.139435, 82.139435, 82.139435, ..., 82.139435, 82.139435,
         82.139435],
        [83.761734, 83.74754 , 83.73415 , ..., 83.80205 , 83.78787 ,
         83.77512 ],
        [83.46112 , 83.433556, 83.406906, ..., 83.54371 , 83.51649 ,
         83.48877 ],
...
        [49.46871 , 49.473732, 49.47947 , ..., 49.45213 , 49.457184,
         49.462948],
        [50.498913, 50.502045, 50.504723, ..., 50.490997, 50.49326 ,
         50.495842],
        [51.531967, 51.531967, 51.531967, ..., 51.531967, 51.531967,
         51.531967]],

       [[86.03893 , 86.03893 , 86.03893 , ..., 86.03893 , 86.03893 ,
         86.03893 ],
        [85.798   , 85.801216, 85.80586 , ..., 85.78549 , 85.7893  ,
         85.79335 ],
        [85.99098 , 85.95886 , 85.9267  , ..., 86.087494, 86.0556  ,
         86.022995],
        ...,
        [47.22629 , 47.26145 , 47.296997, ..., 47.121544, 47.156128,
         47.191372],
        [47.244663, 47.26062 , 47.276512, ..., 47.197594, 47.212574,
         47.228653],
        [47.742687, 47.742687, 47.742687, ..., 47.742687, 47.742687,
         47.742687]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>so2</span></div><div class='xr-var-dims'>(valid_time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.02272 0.02272 ... 0.00671 0.00671</div><input id='attrs-79daead7-299d-4457-8a30-3037f1a93356' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-79daead7-299d-4457-8a30-3037f1a93356' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-70e40cd3-7234-4485-9190-d3a05997af04' class='xr-var-data-in' type='checkbox'><label for='data-70e40cd3-7234-4485-9190-d3a05997af04' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[0.02272402, 0.02272402, 0.02272402, ..., 0.02272402,
         0.02272402, 0.02272402],
        [0.01429673, 0.01429663, 0.01431528, ..., 0.01424079,
         0.01425944, 0.01427809],
        [0.01469852, 0.01473575, 0.01477298, ..., 0.01462437,
         0.01464288, 0.01468001],
        ...,
        [0.08069566, 0.08056   , 0.08043887, ..., 0.08108839,
         0.08096616, 0.08083128],
        [0.07066717, 0.07067061, 0.07067451, ..., 0.07065534,
         0.07065983, 0.07066327],
        [0.08376341, 0.08376341, 0.08376341, ..., 0.08376341,
         0.08376341, 0.08376341]],

       [[0.01759871, 0.01759871, 0.01759871, ..., 0.01759871,
         0.01759871, 0.01759871],
        [0.00845849, 0.00845858, 0.00845851, ..., 0.00845839,
         0.00845847, 0.00845841],
        [0.0069449 , 0.00709584, 0.0071713 , ..., 0.00671842,
         0.00679388, 0.00686933],
...
        [0.03913969, 0.03914403, 0.0391486 , ..., 0.03924809,
         0.03925209, 0.03913512],
        [0.014842  , 0.01478094, 0.01471974, ..., 0.015068  ,
         0.01500669, 0.0149034 ],
        [0.01178001, 0.01178001, 0.01178001, ..., 0.01178001,
         0.01178001, 0.01178001]],

       [[0.00937552, 0.00937552, 0.00937552, ..., 0.00937552,
         0.00937552, 0.00937552],
        [0.00261252, 0.00261252, 0.00261254, ..., 0.0025357 ,
         0.00261254, 0.00261254],
        [0.00277241, 0.00269546, 0.00261856, ..., 0.00308012,
         0.00292623, 0.0028493 ],
        ...,
        [0.03181028, 0.03181294, 0.03187732, ..., 0.03173983,
         0.03174278, 0.03180685],
        [0.01359988, 0.01360059, 0.01366341, ..., 0.01359806,
         0.01359845, 0.01359916],
        [0.00671046, 0.00671046, 0.00671046, ..., 0.00671046,
         0.00671046, 0.00671046]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f1799579-119f-4bc2-89ca-e627174a5184' class='xr-section-summary-in' type='checkbox'  ><label for='section-f1799579-119f-4bc2-89ca-e627174a5184' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-136195ad-b256-4fcb-9160-ca20e1341f57' class='xr-index-data-in' type='checkbox'/><label for='index-136195ad-b256-4fcb-9160-ca20e1341f57' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([              90.0,               89.6,  89.19999999999999,
        88.79999999999998,  88.39999999999998,  87.99999999999997,
        87.59999999999997,  87.19999999999996,  86.79999999999995,
        86.39999999999995,
       ...
       -86.40000000000036, -86.80000000000037, -87.20000000000037,
       -87.60000000000038, -88.00000000000038, -88.40000000000039,
        -88.8000000000004,  -89.2000000000004,  -89.6000000000004,
                    -90.0],
      dtype=&#x27;float64&#x27;, name=&#x27;latitude&#x27;, length=451))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>longitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-ec9b7517-c82e-4683-b4fc-ca312f2b55a0' class='xr-index-data-in' type='checkbox'/><label for='index-ec9b7517-c82e-4683-b4fc-ca312f2b55a0' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([             -180.0,              -179.6,              -179.2,
       -178.79999999999998, -178.39999999999998, -177.99999999999997,
       -177.59999999999997, -177.19999999999996, -176.79999999999995,
       -176.39999999999995,
       ...
         176.0000000000029,   176.4000000000029,   176.8000000000029,
        177.20000000000292,  177.60000000000292,  178.00000000000293,
        178.40000000000293,  178.80000000000294,  179.20000000000294,
                     179.6],
      dtype=&#x27;float64&#x27;, name=&#x27;longitude&#x27;, length=900))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>valid_time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-3bc06ee6-d220-472f-a4aa-758c3258b7c0' class='xr-index-data-in' type='checkbox'/><label for='index-3bc06ee6-d220-472f-a4aa-758c3258b7c0' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2024-10-03&#x27;, &#x27;2024-10-04&#x27;, &#x27;2024-10-05&#x27;, &#x27;2024-10-06&#x27;], dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;valid_time&#x27;, freq=&#x27;D&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-5d8a0b99-fddc-4425-b4bf-810939fcd725' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5d8a0b99-fddc-4425-b4bf-810939fcd725' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>GRIB_centre :</span></dt><dd>ecmf</dd><dt><span>GRIB_centreDescription :</span></dt><dd>European Centre for Medium-Range Weather Forecasts</dd><dt><span>GRIB_subCentre :</span></dt><dd>0</dd><dt><span>Conventions :</span></dt><dd>CF-1.7</dd><dt><span>institution :</span></dt><dd>European Centre for Medium-Range Weather Forecasts</dd><dt><span>history :</span></dt><dd>2024-10-04T07:51 GRIB to CDM+CF via cfgrib-0.9.14.1/ecCodes-2.36.0 with {&quot;source&quot;: &quot;data.grib&quot;, &quot;filter_by_keys&quot;: {&quot;typeOfLevel&quot;: &quot;surface&quot;}, &quot;encode_cf&quot;: [&quot;parameter&quot;, &quot;time&quot;, &quot;geography&quot;, &quot;vertical&quot;]}</dd></dl></div></li></ul></div></div></div></div>
</div>
</section>
<section id="plotting-the-global-concentrations-forecasts-of-trace-gases-and-particulate-matter">
<h2>Plotting the global concentrations forecasts of trace gases and particulate matter<a class="headerlink" href="#plotting-the-global-concentrations-forecasts-of-trace-gases-and-particulate-matter" title="Permalink to this heading">#</a></h2>
<p>We plot the forecasts for the concentrations of the five pollutants for one day. We can plot any of the other forecast day by simply changing its day index (from 0 to 3)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;no2&#39;</span><span class="p">,</span><span class="s1">&#39;go3&#39;</span><span class="p">,</span><span class="s1">&#39;so2&#39;</span><span class="p">,</span><span class="s1">&#39;pm2p5&#39;</span><span class="p">,</span><span class="s1">&#39;pm10&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>We define the levels of the pollutants to be plotted in order to map the values within each interval using a predefined colormap. We use different levels for each pollutant according to the concentration levels defined for the European Air Quality Index.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">no2_limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">340</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>
<span class="n">o3_limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">380</span><span class="p">,</span> <span class="mi">800</span><span class="p">]</span>
<span class="n">so2_limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">350</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">1250</span><span class="p">]</span>
<span class="n">pm25_limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">800</span><span class="p">]</span>
<span class="n">pm10_limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">1200</span><span class="p">]</span>

<span class="n">all_levels</span> <span class="o">=</span> <span class="p">[</span><span class="n">no2_limits</span><span class="p">,</span> <span class="n">o3_limits</span><span class="p">,</span> <span class="n">so2_limits</span><span class="p">,</span> <span class="n">pm25_limits</span><span class="p">,</span> <span class="n">pm10_limits</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">day_index</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># index of the daily forecasts, from 0 to 3</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()},</span>
                        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">layout</span><span class="o">=</span><span class="s1">&#39;constrained&#39;</span><span class="p">)</span> 
<span class="n">axs</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">days</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">day</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span> <span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="n">eaqi_daily</span><span class="o">.</span><span class="n">valid_time</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()]</span>
<span class="n">fig</span><span class="o">.</span><span class="n">delaxes</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">eaqi_daily</span><span class="p">[</span><span class="n">param</span><span class="p">]</span>
    <span class="n">clevs</span> <span class="o">=</span> <span class="n">all_levels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">day</span> <span class="o">=</span> <span class="n">days</span><span class="p">[</span><span class="n">day_index</span><span class="p">]</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">da</span><span class="p">[</span><span class="n">day_index</span><span class="p">,:,:]</span> 
    <span class="n">cs</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="n">da</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> 
                        <span class="n">levels</span> <span class="o">=</span> <span class="n">clevs</span><span class="p">,</span> 
                        <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;YlOrRd&#39;</span><span class="p">,</span> <span class="c1"># &#39;RdYlBu_r&#39;, </span>
                        <span class="n">norm</span> <span class="o">=</span> <span class="n">mcol</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">clevs</span><span class="p">,</span> <span class="mi">256</span><span class="p">),</span> 
                        <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

    <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.046</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="n">clevs</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">param</span> <span class="o">+</span> <span class="s1">&#39; $\mu g \cdot m^{-3}$&#39;</span><span class="p">)</span>
    <span class="c1">#axs[i].set_yticklabels(clevs)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">bb_west</span><span class="p">,</span> <span class="n">bb_east</span><span class="p">,</span> <span class="n">bb_south</span><span class="p">,</span> <span class="n">bb_north</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span> 
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">param</span> <span class="o">+</span> <span class="s1">&#39; - day: &#39;</span> <span class="o">+</span> <span class="n">day</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span> 
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAKES</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5779f5ec84d0bbc484cd3b4f00e1eb28e8dc98bfa031ee401162057306236eb6.png" src="_images/5779f5ec84d0bbc484cd3b4f00e1eb28e8dc98bfa031ee401162057306236eb6.png" />
</div>
</div>
</section>
<section id="calculating-the-air-quality-index">
<h2>Calculating the air quality index<a class="headerlink" href="#calculating-the-air-quality-index" title="Permalink to this heading">#</a></h2>
<p>With the concentration of the five polluttants we can calculate the air quality index. The air quality index of a pollutant X can be calculated using the equation</p>
<div class="math notranslate nohighlight">
\[I_x = \frac{I_{high} - I_{low}}{C_{high} - C_{low}}(C_x - C_{low}) + I_{low}\]</div>
<p>where <span class="math notranslate nohighlight">\(I_{high}\)</span> is the right AQI index value of the interval that contains the concentration value <span class="math notranslate nohighlight">\(C_x\)</span>, <span class="math notranslate nohighlight">\(I_{low}\)</span> is the left AQI index value, and <span class="math notranslate nohighlight">\(C_{low}\)</span> and <span class="math notranslate nohighlight">\(C_{high}\)</span> are the concentration thresholds of that interval.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(NO_2\)</span> <span class="math notranslate nohighlight">\((\mu g/m^3)\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(O_3\)</span> <span class="math notranslate nohighlight">\((\mu g/m^3)\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(SO_2\)</span> <span class="math notranslate nohighlight">\((\mu g/m^3)\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(PM2.5\)</span> <span class="math notranslate nohighlight">\((\mu g/m^3)\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(PM10\)</span> <span class="math notranslate nohighlight">\((\mu g/m^3)\)</span></p></th>
<th class="head"><p>AQI</p></th>
<th class="head"><p>Category</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0-40</p></td>
<td><p>0-50</p></td>
<td><p>0-100</p></td>
<td><p>0-10</p></td>
<td><p>0-20</p></td>
<td><p>1</p></td>
<td><p>Good</p></td>
</tr>
<tr class="row-odd"><td><p>40-90</p></td>
<td><p>50-100</p></td>
<td><p>100-200</p></td>
<td><p>10-20</p></td>
<td><p>20-40</p></td>
<td><p>2</p></td>
<td><p>Fair</p></td>
</tr>
<tr class="row-even"><td><p>90-120</p></td>
<td><p>100-130</p></td>
<td><p>200-350</p></td>
<td><p>20-25</p></td>
<td><p>40-50</p></td>
<td><p>3</p></td>
<td><p>Moderate</p></td>
</tr>
<tr class="row-odd"><td><p>120-230</p></td>
<td><p>130-240</p></td>
<td><p>350-500</p></td>
<td><p>25-50</p></td>
<td><p>50-100</p></td>
<td><p>4</p></td>
<td><p>Poor</p></td>
</tr>
<tr class="row-even"><td><p>230-340</p></td>
<td><p>240-380</p></td>
<td><p>500-750</p></td>
<td><p>50-75</p></td>
<td><p>100-150</p></td>
<td><p>5</p></td>
<td><p>Very Poor</p></td>
</tr>
<tr class="row-odd"><td><p>340-1000</p></td>
<td><p>380-800</p></td>
<td><p>750-1250</p></td>
<td><p>75-800</p></td>
<td><p>150-1200</p></td>
<td><p>6</p></td>
<td><p>Extremely Poor</p></td>
</tr>
</tbody>
</table>
<p>We use the same intervals defined for the European Air Quality Index to compute the value of the index from the concentration values of the pollutant</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bin_list</span> <span class="o">=</span> <span class="n">all_levels</span>
</pre></div>
</div>
</div>
</div>
<p>We define a function to map the concentration values to one of the intervals that have been defined for the air quality index</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">classify_forecast_variables</span><span class="p">(</span><span class="n">forecast_ds</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This function assigns an integer value according to a class </span>
<span class="sd">    for each float value in the dataset.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">classified_arrays</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">forecast_ds</span><span class="p">)):</span>
        <span class="n">variable</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">apply_ufunc</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">digitize</span><span class="p">,</span>
                              <span class="n">forecast_ds</span><span class="p">[</span><span class="n">variable</span><span class="p">],</span>
                              <span class="n">bin_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">classified_arrays</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
        <span class="n">combined_arrays</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">classified_arrays</span><span class="p">)</span>
        <span class="n">final_index</span> <span class="o">=</span> <span class="n">combined_arrays</span><span class="o">.</span><span class="n">to_array</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s1">&#39;variable&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">final_index</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aqi_index</span> <span class="o">=</span> <span class="n">classify_forecast_variables</span><span class="p">(</span><span class="n">eaqi_daily</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We define a colormap for the AQI according to the <a class="reference external" href="https://airindex.eea.europa.eu/AQI/index.html">EEA colourscale</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">good_color</span> <span class="o">=</span> <span class="s1">&#39;#03fcf0&#39;</span>
<span class="n">fair_color</span> <span class="o">=</span> <span class="s1">&#39;#16d984&#39;</span>
<span class="n">moderate_color</span> <span class="o">=</span> <span class="s1">&#39;#dffa11&#39;</span>
<span class="n">poor_color</span> <span class="o">=</span> <span class="s1">&#39;#db4918&#39;</span>
<span class="n">very_poor_color</span> <span class="o">=</span> <span class="s1">&#39;#873c23&#39;</span>
<span class="n">extremely_poor_color</span> <span class="o">=</span> <span class="s1">&#39;#5a2387&#39;</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">good_color</span><span class="p">,</span> <span class="n">fair_color</span><span class="p">,</span> <span class="n">moderate_color</span><span class="p">,</span> <span class="n">poor_color</span><span class="p">,</span> <span class="n">very_poor_color</span><span class="p">,</span> <span class="n">extremely_poor_color</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Good&#39;</span><span class="p">,</span> <span class="s1">&#39;Fair&#39;</span><span class="p">,</span> <span class="s1">&#39;Moderate&#39;</span><span class="p">,</span> <span class="s1">&#39;Poor&#39;</span><span class="p">,</span> <span class="s1">&#39;Very Poor&#39;</span><span class="p">,</span> <span class="s1">&#39;Extremely Poor&#39;</span><span class="p">]</span>
<span class="n">levels</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">]</span>
<span class="n">level_ticks</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">aqi_cmap</span> <span class="o">=</span> <span class="n">ListedColormap</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="global-aqi-map">
<h2>Global AQI map<a class="headerlink" href="#global-aqi-map" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">day</span> <span class="o">=</span> <span class="s1">&#39;2024-10-05&#39;</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()},</span>
                       <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
<span class="n">timestamp</span> <span class="o">=</span> <span class="n">aqi_index</span><span class="o">.</span><span class="n">valid_time</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">aqi_index</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">valid_time</span><span class="o">=</span><span class="n">day</span><span class="p">)</span>
<span class="n">cs</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">aqi_index</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> 
                       <span class="n">aqi_index</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> 
                       <span class="n">data</span><span class="p">,</span>
                       <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> 
                       <span class="n">cmap</span><span class="o">=</span><span class="n">aqi_cmap</span><span class="p">,</span>
                       <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;CAMS Global Air Quality Index Daily forecast - &#39;</span> <span class="o">+</span> <span class="n">day</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;50m&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">bb_west</span><span class="p">,</span> <span class="n">bb_east</span><span class="p">,</span> <span class="n">bb_south</span><span class="p">,</span> <span class="n">bb_north</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    
<span class="c1"># Customize colorbar</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.028</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span> 
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">level_ticks</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c7ebd6681446a39337b3c4861549492b1ea41018658211e6572d1790389e5e2a.png" src="_images/c7ebd6681446a39337b3c4861549492b1ea41018658211e6572d1790389e5e2a.png" />
</div>
</div>
</section>
<section id="air-quality-heatmap-for-kjeller">
<h2>Air quality heatmap for Kjeller<a class="headerlink" href="#air-quality-heatmap-for-kjeller" title="Permalink to this heading">#</a></h2>
<p>We can plot the air quality forecast of the polluttants as heatmap for any location by using its latitude and longitude. In this example we will plot the air quality forecast heatmap for Kjeller, a village east of Oslo, Norway. We will map the concentration of the polluttants in Kjeller to the classes defined for the air quality calculation. This step is similar to what was done before for the global map. After the ma</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kjeller_lat</span> <span class="o">=</span> <span class="mf">59.9742</span>
<span class="n">kjeller_lon</span> <span class="o">=</span> <span class="mf">11.0469</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kjeller_day</span> <span class="o">=</span> <span class="n">eaqi_daily</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">latitude</span> <span class="o">=</span> <span class="n">kjeller_lat</span><span class="p">,</span> <span class="n">longitude</span> <span class="o">=</span> <span class="n">kjeller_lon</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">days</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">day</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span> <span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="n">kjeller_day</span><span class="o">.</span><span class="n">valid_time</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()]</span>
<span class="n">days_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">days</span><span class="p">)</span>
<span class="n">days_index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DatetimeIndex([&#39;2024-10-03&#39;, &#39;2024-10-04&#39;, &#39;2024-10-05&#39;, &#39;2024-10-06&#39;], dtype=&#39;datetime64[ns]&#39;, freq=None)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">classify_forecast</span><span class="p">(</span><span class="n">forecast_ds</span><span class="p">,</span> <span class="n">bin_list</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This function assigns an integer value according to a class </span>
<span class="sd">    in the bin_list to each float value in the input dataset.</span>
<span class="sd">    The function returns a Pandas series.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">classified_arrays</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">apply_ufunc</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">digitize</span><span class="p">,</span>
                          <span class="n">forecast_ds</span><span class="p">,</span>
                          <span class="n">bin_list</span><span class="p">)</span>
    <span class="n">classified_arrays</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
    <span class="n">combined_arrays</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">classified_arrays</span><span class="p">)</span>
    <span class="n">aqi_index</span> <span class="o">=</span> <span class="n">combined_arrays</span><span class="o">.</span><span class="n">to_array</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s1">&#39;variable&#39;</span><span class="p">)</span>
    <span class="n">aqi_ds</span> <span class="o">=</span> <span class="n">aqi_index</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">aqi_ds</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kjeller_no2</span> <span class="o">=</span> <span class="n">classify_forecast</span><span class="p">(</span><span class="n">kjeller_day</span><span class="p">[</span><span class="s1">&#39;no2&#39;</span><span class="p">],</span> <span class="n">no2_limits</span><span class="p">)</span>
<span class="n">kjeller_o3</span> <span class="o">=</span> <span class="n">classify_forecast</span><span class="p">(</span><span class="n">kjeller_day</span><span class="p">[</span><span class="s1">&#39;go3&#39;</span><span class="p">],</span> <span class="n">o3_limits</span><span class="p">)</span>
<span class="n">kjeller_so2</span> <span class="o">=</span> <span class="n">classify_forecast</span><span class="p">(</span><span class="n">kjeller_day</span><span class="p">[</span><span class="s1">&#39;so2&#39;</span><span class="p">],</span> <span class="n">so2_limits</span><span class="p">)</span>
<span class="n">kjeller_pm25</span> <span class="o">=</span> <span class="n">classify_forecast</span><span class="p">(</span><span class="n">kjeller_day</span><span class="p">[</span><span class="s1">&#39;pm2p5&#39;</span><span class="p">],</span> <span class="n">pm25_limits</span><span class="p">)</span>
<span class="n">kjeller_pm10</span> <span class="o">=</span> <span class="n">classify_forecast</span><span class="p">(</span><span class="n">kjeller_day</span><span class="p">[</span><span class="s1">&#39;pm10&#39;</span><span class="p">],</span> <span class="n">pm10_limits</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kjeller_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;pm10&#39;</span><span class="p">:</span> <span class="n">kjeller_pm10</span><span class="p">,</span>
                <span class="s1">&#39;pm25&#39;</span><span class="p">:</span> <span class="n">kjeller_pm25</span><span class="p">,</span>
                <span class="s1">&#39;so2&#39;</span><span class="p">:</span> <span class="n">kjeller_so2</span><span class="p">,</span>
                <span class="s1">&#39;o3&#39;</span><span class="p">:</span> <span class="n">kjeller_o3</span><span class="p">,</span>
                <span class="s1">&#39;no2&#39;</span><span class="p">:</span> <span class="n">kjeller_no2</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kjeller_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">kjeller_dict</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">days_index</span><span class="p">)</span>
<span class="n">kjeller_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pm10</th>
      <th>pm25</th>
      <th>so2</th>
      <th>o3</th>
      <th>no2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2024-10-03</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2024-10-04</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2024-10-05</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2024-10-06</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kjeller_df</span> <span class="o">=</span> <span class="p">(</span><span class="n">kjeller_df</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">kjeller_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>2024-10-03</th>
      <th>2024-10-04</th>
      <th>2024-10-05</th>
      <th>2024-10-06</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>no2</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>o3</th>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>so2</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>pm25</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>pm10</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="c1">#cbar_ax = fig.add_axes([.82, .13, .01, .75])</span>
<span class="c1">#fig.tight_layout()</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">kjeller_df</span><span class="p">,</span> 
                <span class="n">cmap</span><span class="o">=</span><span class="n">aqi_cmap</span><span class="p">,</span> 
                <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> 
                <span class="n">linecolor</span> <span class="o">=</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> 
                <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                <span class="c1">#cbar_ax = cbar_ax, </span>
                <span class="n">vmin</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> 
                <span class="n">vmax</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">g</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Air Quality Index Forecast - Kjeller</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="c1">#g.set(xlabel=None)</span>

<span class="n">g</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">xlabels</span> <span class="o">=</span> <span class="n">kjeller_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">::]</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">xlabels</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">);</span>

<span class="c1"># Customize colorbar entries</span>
<span class="c1">#cbar = ax.collections[0].colorbar  </span>
<span class="c1">#cbar.set_ticks([1.4,2.2,3.1,3.9,4.8,5.6])</span>
<span class="c1">#cbar.set_ticklabels(labels)</span>
<span class="c1">#cbar.ax.tick_params(labelsize=11)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/95f3e3fa206432da22be1e608732ae3771cf48c3035bc1e0cf2160cf96b38357.png" src="_images/95f3e3fa206432da22be1e608732ae3771cf48c3035bc1e0cf2160cf96b38357.png" />
</div>
</div>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://acmg.seas.harvard.edu/education/introduction-atmospheric-chemistry">Jacob - Introduction to Atmospheric Chemistry</a></p></li>
<li><p>Wilks - Statistical Methods in Atmospheric Science, 2nd Edition</p></li>
</ul>
</section>
<section id="appendix-scaling-factor">
<h2>Appendix - Scaling factor<a class="headerlink" href="#appendix-scaling-factor" title="Permalink to this heading">#</a></h2>
<p>We start from the definition of mass mixing ratio of a chemical species X in air</p>
<div class="math notranslate nohighlight">
\[\alpha_x = \frac{\rho_x}{\rho}\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho_x\)</span> is the mass density of the chemical species X in <span class="math notranslate nohighlight">\(kgm^{-3}\)</span> and <span class="math notranslate nohighlight">\(\rho\)</span> is the mass density of the air. We assume the trace gases and the dry air to follow the ideal gas law so that for dry air we can write</p>
<div class="math notranslate nohighlight">
\[pV = nRT\]</div>
<p>where p is the air pressure, <span class="math notranslate nohighlight">\(R = K_B N_A = 8.314 \text{ } JK^{-1}mol^{-1}\)</span> is the ideal gas constant, where <span class="math notranslate nohighlight">\(K_B\)</span> is the Boltzmann constant and <span class="math notranslate nohighlight">\(N_A\)</span> is the Avogadro’s number, V the volume, T the temperature, and finally n is the number of moles. The number of moles is defined as the ratio of the mass and the molar mass. For dry air, a mixture of several gases, the molar mass <span class="math notranslate nohighlight">\(M_a\)</span> can be represented by the weighted sum of the molar masses of all the chemical species in the air (see Jacob, chap.1, p.4)</p>
<div class="math notranslate nohighlight">
\[M_a = \sum_i w_iM_i = 28.96 \cdot 10^{-3} \text{ } kg\text{ }mol^{-1}\]</div>
<p>With this defnition the number of moles of dry air can be written as</p>
<div class="math notranslate nohighlight">
\[n = \frac{m}{M_a}\]</div>
<p>where m is the mass of the dry air. Substituting this definition into the gas law for dry air we have</p>
<div class="math notranslate nohighlight">
\[pV = \frac{m}{M_a}RT\]</div>
<p>We can define the gas constant of dry air from the ideal gas constant R and the molar mass of dry air</p>
<div class="math notranslate nohighlight">
\[R_a = \frac{R}{M_a} = \frac{8.314 \text{ } JK^{-1}mol^{-1}}{28.96 \cdot 10^{-3} \text{ } kg\text{ }mol^{-1}} = 287.08 \text{ } JK^{-1}kg^{-1}\]</div>
<p>We can now write the law for dry air as</p>
<div class="math notranslate nohighlight">
\[pV = mR_aT\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[p = \frac{m}{V}R_aT = \rho R_aT\]</div>
<p>so that the mass density of dry air is</p>
<div class="math notranslate nohighlight">
\[\rho = \frac{p}{R_aT}\]</div>
<p>from which we can write the equation of the mass density of a chemical species in the air as a function of its mixing ratio, the air pressure and temperature, and given the air specific gas constant</p>
<div class="math notranslate nohighlight">
\[\rho_x = \alpha_x \frac{p}{R_aT} \text{ } kg m^{-3}\]</div>
<p>If we define the factor c as</p>
<div class="math notranslate nohighlight">
\[c = \frac{p}{R_aT}\]</div>
<p>we can transform the mixing ratio of a chemical species to mass density using the equation</p>
<div class="math notranslate nohighlight">
\[\rho_x = c \alpha_x\]</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="proc-aq-index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">European Air Quality Index Calculation</p>
      </div>
    </a>
    <a class="right-next"
       href="proc-ozone.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Antarctic Ozone Hole Monitoring Tutorial</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-objectives">Learning objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-setup">Initial setup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#add-your-ads-api-credentials">Add your ADS API credentials</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries">Import libraries</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#explore-and-download-data">Explore and download data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#manual-download">Manual download</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#api-download">API download</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aerosols-and-meteorological-data">Aerosols and meteorological data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trace-gases">Trace gases</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unit-transformation">Unit transformation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#h-max-and-mean-average">24h max and mean average</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-the-global-concentrations-forecasts-of-trace-gases-and-particulate-matter">Plotting the global concentrations forecasts of trace gases and particulate matter</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-the-air-quality-index">Calculating the air quality index</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#global-aqi-map">Global AQI map</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#air-quality-heatmap-for-kjeller">Air quality heatmap for Kjeller</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#appendix-scaling-factor">Appendix - Scaling factor</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Atmosphere Monitoring Service (CAMS), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>